"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/game/new/page",{

/***/ "(app-pages-browser)/./src/lib/gameApi.ts":
/*!****************************!*\
  !*** ./src/lib/gameApi.ts ***!
  \****************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createGame: function() { return /* binding */ createGame; },\n/* harmony export */   getGameState: function() { return /* binding */ getGameState; },\n/* harmony export */   joinGame: function() { return /* binding */ joinGame; },\n/* harmony export */   placeBet: function() { return /* binding */ placeBet; },\n/* harmony export */   sendMessage: function() { return /* binding */ sendMessage; },\n/* harmony export */   startGame: function() { return /* binding */ startGame; },\n/* harmony export */   updateSeat: function() { return /* binding */ updateSeat; }\n/* harmony export */ });\n/* harmony import */ var _supabase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./supabase */ \"(app-pages-browser)/./src/lib/supabase.ts\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! uuid */ \"(app-pages-browser)/./node_modules/uuid/dist/esm-browser/v4.js\");\n/* harmony import */ var _utils_gameLogic__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/utils/gameLogic */ \"(app-pages-browser)/./src/utils/gameLogic.ts\");\n\n\n\n// 상수 정의 (파일 상단에 추가)\nconst REGAME_WAIT_TIME_MS = 5000; // 재경기 대기 시간 (5초)\n/**\n * 새로운 게임 생성\n */ async function createGame(username) {\n    const gameId = (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])();\n    const playerId = (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])();\n    // 임시 사용자 ID 생성\n    const userId = \"user_\".concat(Math.random().toString(36).substring(2, 9));\n    try {\n        // 게임 생성\n        const { data: gameData, error: gameError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"games\").insert({\n            id: gameId,\n            status: \"waiting\",\n            current_turn: null,\n            betting_value: 0,\n            winner: null\n        }).select();\n        if (gameError) {\n            console.error(\"게임 생성 오류 세부 정보:\", gameError);\n            throw new Error(\"게임을 생성할 수 없습니다: \" + gameError.message);\n        }\n        console.log(\"게임 생성 성공:\", gameId);\n        // 관찰자 모드로 시작하므로 플레이어를 생성하지 않음\n        // 클라이언트는 빈 자리를 클릭해 참여해야 함\n        return {\n            gameId,\n            playerId: null\n        };\n    } catch (err) {\n        console.error(\"게임 생성 중 예외 발생:\", err);\n        throw err;\n    }\n}\n/**\n * 기존 게임에 참가\n */ async function joinGame(gameId, username, seatIndex) {\n    try {\n        // 게임 상태 체크\n        const { data: gameData, error: gameError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"games\").select(\"*\").eq(\"id\", gameId).single();\n        if (gameError || !gameData) {\n            console.error(\"게임 조회 오류 세부 정보:\", gameError);\n            throw new Error(\"게임을 찾을 수 없습니다: \" + ((gameError === null || gameError === void 0 ? void 0 : gameError.message) || \"알 수 없는 오류\"));\n        }\n        // 로컬 스토리지에서 사용자 ID와 플레이어 ID 확인\n        const storedUserId = localStorage.getItem(\"game_\".concat(gameId, \"_user_id\"));\n        const storedPlayerId = localStorage.getItem(\"game_\".concat(gameId, \"_player_id\"));\n        // 기존 참여자인지 확인\n        if (storedUserId && storedPlayerId) {\n            // 기존 플레이어 정보 조회\n            const { data: existingPlayer, error: existingPlayerError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"players\").select(\"*\").eq(\"game_id\", gameId).eq(\"id\", storedPlayerId).single();\n            if (!existingPlayerError && existingPlayer) {\n                console.log(\"기존 플레이어로 재접속:\", existingPlayer.id);\n                // 이름 업데이트가 필요한 경우\n                if (existingPlayer.username !== username) {\n                    await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"players\").update({\n                        username\n                    }).eq(\"id\", existingPlayer.id);\n                }\n                // 최신 게임 상태 가져오기\n                const gameState = await getGameState(gameId);\n                return {\n                    playerId: existingPlayer.id,\n                    gameState,\n                    rejoined: true\n                };\n            }\n        }\n        // 새 플레이어 참가 (게임이 대기 중일 때만)\n        if (gameData.status !== \"waiting\") {\n            throw new Error(\"이미 시작된 게임에는 참가할 수 없습니다.\");\n        }\n        const playerId = (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])();\n        // 임시 사용자 ID 생성\n        const userId = \"user_\".concat(Math.random().toString(36).substring(2, 9));\n        // 플레이어 생성\n        const { data: playerData, error: playerError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"players\").insert({\n            id: playerId,\n            game_id: gameId,\n            user_id: userId,\n            username,\n            balance: 10000,\n            is_die: false,\n            seat_index: seatIndex\n        }).select();\n        if (playerError) {\n            console.error(\"플레이어 생성 오류 세부 정보:\", playerError);\n            throw new Error(\"게임에 참가할 수 없습니다: \" + playerError.message);\n        }\n        console.log(\"플레이어 참가 성공:\", playerId);\n        // 로컬 스토리지에 사용자 정보 저장\n        localStorage.setItem(\"game_\".concat(gameId, \"_user_id\"), userId);\n        localStorage.setItem(\"game_\".concat(gameId, \"_player_id\"), playerId);\n        // 최신 게임 상태 가져오기\n        const gameState = await getGameState(gameId);\n        return {\n            playerId,\n            gameState\n        };\n    } catch (err) {\n        console.error(\"게임 참가 중 예외 발생:\", err);\n        throw err;\n    }\n}\n/**\n * 게임 상태 조회\n */ async function getGameState(gameId) {\n    // 게임 정보 가져오기\n    const { data: gameData, error: gameError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"games\").select(\"*\").eq(\"id\", gameId).single();\n    if (gameError || !gameData) {\n        console.error(\"게임 조회 오류:\", gameError);\n        throw new Error(\"게임을 찾을 수 없습니다.\");\n    }\n    // 플레이어 정보 가져오기\n    const { data: playersData, error: playersError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"players\").select(\"*\").eq(\"game_id\", gameId);\n    if (playersError) {\n        console.error(\"플레이어 조회 오류:\", playersError);\n        throw new Error(\"플레이어 정보를 불러올 수 없습니다.\");\n    }\n    // 재경기 남은 시간 계산\n    let regameRemainingTime = undefined;\n    if (gameData.status === \"regame\" && gameData.regame_start_time && gameData.regame_wait_time) {\n        const startTime = new Date(gameData.regame_start_time).getTime();\n        const currentTime = new Date().getTime();\n        const elapsedMs = currentTime - startTime;\n        const remainingMs = Math.max(0, gameData.regame_wait_time - elapsedMs);\n        regameRemainingTime = Math.ceil(remainingMs / 1000);\n    }\n    // 게임 상태 정보 포맷팅\n    const gameState = {\n        id: gameData.id,\n        status: gameData.status,\n        players: playersData.map((player)=>({\n                id: player.id,\n                user_id: player.user_id,\n                username: player.username,\n                balance: player.balance,\n                cards: player.cards || [],\n                isDie: player.is_die\n            })),\n        currentTurn: gameData.current_turn || \"\",\n        winner: gameData.winner,\n        bettingValue: gameData.betting_value,\n        regame_remaining_time: regameRemainingTime,\n        regame_start_time: gameData.regame_start_time\n    };\n    return gameState;\n}\n/**\n * 게임 시작\n */ async function startGame(gameId) {\n    // 게임 및 플레이어 정보 가져오기\n    const { data: playersData, error: playersError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"players\").select(\"id\").eq(\"game_id\", gameId);\n    if (playersError || !playersData || playersData.length < 2) {\n        throw new Error(\"최소 2명의 플레이어가 필요합니다.\");\n    }\n    // 카드 덱 생성 및 셔플\n    const deck = createShuffledDeck();\n    // 플레이어들에게 카드 배분 및 업데이트\n    for(let i = 0; i < playersData.length; i++){\n        const playerCards = [\n            deck.pop(),\n            deck.pop()\n        ].filter(Boolean);\n        const { error: updateError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"players\").update({\n            cards: playerCards\n        }).eq(\"id\", playersData[i].id);\n        if (updateError) {\n            console.error(\"플레이어 카드 업데이트 오류:\", updateError);\n            throw new Error(\"카드를 배분할 수 없습니다.\");\n        }\n    }\n    // 첫 턴을 랜덤으로 선택\n    const firstTurn = playersData[Math.floor(Math.random() * playersData.length)].id;\n    // 게임 상태 업데이트\n    const { error: updateError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"games\").update({\n        status: \"playing\",\n        current_turn: firstTurn,\n        betting_value: 0\n    }).eq(\"id\", gameId);\n    if (updateError) {\n        console.error(\"게임 상태 업데이트 오류:\", updateError);\n        throw new Error(\"게임을 시작할 수 없습니다.\");\n    }\n    // 게임 시작 액션 기록\n    await recordGameAction(gameId, \"start\", firstTurn);\n}\n/**\n * 베팅\n */ async function placeBet(gameId, playerId, actionType, amount) {\n    // 게임 상태 확인\n    const gameState = await getGameState(gameId);\n    if (gameState.status !== \"playing\") {\n        throw new Error(\"게임이 진행 중이 아닙니다.\");\n    }\n    if (gameState.currentTurn !== playerId) {\n        throw new Error(\"당신의 턴이 아닙니다.\");\n    }\n    const player = gameState.players.find((p)=>p.id === playerId);\n    if (!player) {\n        throw new Error(\"플레이어를 찾을 수 없습니다.\");\n    }\n    // 최근 배팅 액션 조회\n    const { data: actionsData, error: actionsError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"game_actions\").select(\"*\").eq(\"game_id\", gameId).order(\"created_at\", {\n        ascending: false\n    }).limit(10);\n    if (actionsError) {\n        console.error(\"게임 액션 조회 오류:\", actionsError);\n        throw new Error(\"게임 액션을 조회할 수 없습니다.\");\n    }\n    // 마지막 배팅 액션 찾기\n    const lastBetAction = actionsData === null || actionsData === void 0 ? void 0 : actionsData.find((action)=>[\n            \"bet\",\n            \"raise\",\n            \"call\",\n            \"half\"\n        ].includes(action.action_type) && action.player_id !== playerId);\n    // 액션 별 배팅 금액 계산\n    let betAmount = 0;\n    const baseBet = gameState.baseBet || 500; // 기본 배팅액\n    switch(actionType){\n        case \"check\":\n            // 이전 베팅이 없을 때만 가능\n            if (lastBetAction && lastBetAction.amount > 0) {\n                throw new Error(\"이전 베팅이 있어 체크할 수 없습니다.\");\n            }\n            betAmount = 0;\n            break;\n        case \"call\":\n            // 이전 베팅액과 동일하게\n            betAmount = (lastBetAction === null || lastBetAction === void 0 ? void 0 : lastBetAction.amount) || baseBet;\n            break;\n        case \"half\":\n            // 팟의 절반\n            betAmount = Math.floor(gameState.bettingValue / 2);\n            // 최소 기본 배팅액 보장\n            betAmount = betAmount < baseBet ? baseBet : betAmount;\n            break;\n        case \"bet\":\n        case \"raise\":\n            // 사용자가 지정한 금액\n            if (!amount || amount <= 0) {\n                throw new Error(\"베팅 금액은 0보다 커야 합니다.\");\n            }\n            // 최소 베팅액 확인\n            const minBet = lastBetAction ? lastBetAction.amount * 2 : baseBet;\n            if (amount < minBet) {\n                throw new Error(\"최소 베팅액은 \".concat(minBet, \"입니다.\"));\n            }\n            // 최대 베팅액 (올인 이외)은 보유량\n            betAmount = amount;\n            break;\n        case \"die\":\n            // 다이는 비용 없음\n            betAmount = 0;\n            break;\n        default:\n            throw new Error(\"잘못된 액션 타입입니다.\");\n    }\n    // 잔액 확인\n    if (actionType !== \"die\" && player.balance < betAmount) {\n        throw new Error(\"잔액이 부족합니다.\");\n    }\n    // 액션 처리\n    if (actionType === \"die\") {\n        // 플레이어를 다이 상태로 변경\n        const { error: playerUpdateError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"players\").update({\n            is_die: true\n        }).eq(\"id\", playerId);\n        if (playerUpdateError) {\n            console.error(\"플레이어 다이 상태 업데이트 오류:\", playerUpdateError);\n            throw new Error(\"다이할 수 없습니다.\");\n        }\n        // 남은 플레이어 확인\n        const activePlayers = gameState.players.filter((p)=>p.id !== playerId && !p.isDie);\n        if (activePlayers.length === 1) {\n            // 한 명만 남았으면 게임 종료\n            const winner = activePlayers[0].id;\n            // 승자의 잔액 업데이트\n            const { error: winnerUpdateError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"players\").update({\n                balance: activePlayers[0].balance + gameState.bettingValue\n            }).eq(\"id\", winner);\n            if (winnerUpdateError) {\n                console.error(\"승자 잔액 업데이트 오류:\", winnerUpdateError);\n                throw new Error(\"승자 잔액을 업데이트할 수 없습니다.\");\n            }\n            // 게임 종료 상태 업데이트\n            const { error: gameUpdateError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"games\").update({\n                status: \"finished\",\n                winner: winner\n            }).eq(\"id\", gameId);\n            if (gameUpdateError) {\n                console.error(\"게임 종료 상태 업데이트 오류:\", gameUpdateError);\n                throw new Error(\"게임을 종료할 수 없습니다.\");\n            }\n            // 액션 기록\n            await recordGameAction(gameId, \"die\", playerId);\n            return;\n        } else {\n            // 다음 플레이어 결정\n            const nextPlayerTurnId = getNextPlayerTurn(gameState.players, playerId);\n            // 게임 상태 업데이트\n            const { error: gameUpdateError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"games\").update({\n                current_turn: nextPlayerTurnId\n            }).eq(\"id\", gameId);\n            if (gameUpdateError) {\n                console.error(\"게임 상태 업데이트 오류:\", gameUpdateError);\n                throw new Error(\"게임 상태를 업데이트할 수 없습니다.\");\n            }\n            // 액션 기록\n            await recordGameAction(gameId, \"die\", playerId);\n            return;\n        }\n    }\n    // 다음 플레이어 결정\n    const nextPlayerTurnId = getNextPlayerTurn(gameState.players, playerId);\n    // 게임 상태 업데이트\n    const { error: gameUpdateError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"games\").update({\n        current_turn: nextPlayerTurnId,\n        betting_value: gameState.bettingValue + betAmount\n    }).eq(\"id\", gameId);\n    if (gameUpdateError) {\n        console.error(\"게임 상태 업데이트 오류:\", gameUpdateError);\n        throw new Error(\"베팅할 수 없습니다.\");\n    }\n    // 플레이어 잔액 업데이트\n    if (betAmount > 0) {\n        const { error: playerUpdateError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"players\").update({\n            balance: player.balance - betAmount\n        }).eq(\"id\", playerId);\n        if (playerUpdateError) {\n            console.error(\"플레이어 잔액 업데이트 오류:\", playerUpdateError);\n            throw new Error(\"잔액을 업데이트할 수 없습니다.\");\n        }\n    }\n    // 모든 플레이어가 액션을 취했는지 확인\n    const allPlayersTookAction = await checkAllPlayersHadTurn(gameId, gameState.players);\n    const allPlayersMatchedBet = await checkAllPlayersMatchedBet(gameId, gameState.players);\n    // 모든 플레이어가 액션을 취했고, 배팅 금액이 일치하면 게임 종료\n    if (allPlayersTookAction && allPlayersMatchedBet) {\n        console.log(\"모든 플레이어 액션 완료, 베팅 금액 일치 - 게임 종료\");\n        await finishGame(gameId);\n    } else {\n        // 디버그 로그\n        if (!allPlayersTookAction) {\n            console.log(\"아직 모든 플레이어가 액션을 취하지 않음\");\n        }\n        if (!allPlayersMatchedBet) {\n            console.log(\"플레이어들의 베팅 금액이 일치하지 않음\");\n        }\n    }\n    // 액션 기록\n    await recordGameAction(gameId, actionType, playerId, betAmount);\n}\n// 모든 플레이어가 동일한 금액을 배팅했는지 확인\nasync function checkAllPlayersMatchedBet(gameId, players) {\n    const activePlayers = players.filter((p)=>!p.isDie);\n    if (activePlayers.length <= 1) {\n        return true;\n    }\n    // 게임 시작 이후 각 플레이어별 마지막 베팅 가져오기\n    const playerLastBets = {};\n    for (const player of activePlayers){\n        const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"game_actions\").select(\"*\").eq(\"game_id\", gameId).eq(\"player_id\", player.id).in(\"action_type\", [\n            \"bet\",\n            \"call\",\n            \"raise\",\n            \"half\",\n            \"check\"\n        ]).order(\"created_at\", {\n            ascending: false\n        }).limit(1);\n        if (error || !data || data.length === 0) {\n            return false; // 데이터가 없으면 아직 일치하지 않음\n        }\n        playerLastBets[player.id] = data[0].amount || 0;\n    }\n    // 베팅액이 모두 같은지 확인\n    const betAmounts = Object.values(playerLastBets);\n    return betAmounts.every((amount)=>amount === betAmounts[0]);\n}\n// 다음 플레이어 턴 가져오기\nfunction getNextPlayerTurn(players, currentPlayerId) {\n    const activePlayers = players.filter((p)=>!p.isDie);\n    if (activePlayers.length <= 1) {\n        return \"\";\n    }\n    const currentIndex = activePlayers.findIndex((p)=>p.id === currentPlayerId);\n    const nextIndex = (currentIndex + 1) % activePlayers.length;\n    return activePlayers[nextIndex].id;\n}\n/**\n * 메시지 전송\n */ async function sendMessage(gameId, playerId, content) {\n    if (!content.trim()) {\n        throw new Error(\"메시지 내용이 비어있습니다.\");\n    }\n    // 플레이어 정보 가져오기\n    const { data: playerData, error: playerError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"players\").select(\"username, user_id\").eq(\"id\", playerId).single();\n    if (playerError || !playerData) {\n        console.error(\"플레이어 정보 조회 오류:\", playerError);\n        throw new Error(\"플레이어 정보를 찾을 수 없습니다.\");\n    }\n    // 메시지 ID 생성\n    const messageId = (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])();\n    const timestamp = new Date().toISOString();\n    // 메시지 객체 생성\n    const messageData = {\n        id: messageId,\n        game_id: gameId,\n        user_id: playerData.user_id,\n        username: playerData.username,\n        content: content,\n        created_at: timestamp\n    };\n    // 메시지 저장\n    const { error: messageError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"messages\").insert(messageData);\n    if (messageError) {\n        console.error(\"메시지 저장 오류:\", messageError);\n        throw new Error(\"메시지를 전송할 수 없습니다: \" + messageError.message);\n    }\n}\n/**\n * 게임 액션 기록\n */ async function recordGameAction(gameId, actionType, playerId, amount) {\n    const { error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"game_actions\").insert({\n        game_id: gameId,\n        player_id: playerId,\n        action_type: actionType,\n        amount: amount\n    });\n    if (error) {\n        console.error(\"게임 액션 기록 오류:\", error);\n        // 액션 기록 실패는 게임 진행에 치명적이지 않으므로 오류를 던지지 않음\n        console.warn(\"게임 액션을 기록할 수 없습니다.\");\n    }\n}\n/**\n * 셔플된 카드 덱 생성\n */ function createShuffledDeck() {\n    // 1부터 20까지의 카드 생성 (섯다 카드)\n    const deck = Array.from({\n        length: 20\n    }, (_, i)=>i + 1);\n    // 덱 셔플 (Fisher-Yates 알고리즘)\n    for(let i = deck.length - 1; i > 0; i--){\n        const j = Math.floor(Math.random() * (i + 1));\n        [deck[i], deck[j]] = [\n            deck[j],\n            deck[i]\n        ];\n    }\n    return deck;\n}\n/**\n * 모든 플레이어가 턴을 가졌는지 확인\n */ async function checkAllPlayersHadTurn(gameId, players) {\n    const activePlayers = players.filter((p)=>!p.isDie);\n    // 게임 시작 이후 각 플레이어별 가장 최근 액션 확인\n    const playerLastActions = new Set();\n    // 게임의 마지막 라운드 시작 시간 찾기 (start 액션 또는 가장 오래된 베팅 액션)\n    const { data: startAction, error: startError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"game_actions\").select(\"created_at\").eq(\"game_id\", gameId).eq(\"action_type\", \"start\").order(\"created_at\", {\n        ascending: false\n    }).limit(1);\n    if (startError) {\n        console.error(\"게임 시작 액션 조회 오류:\", startError);\n        return false;\n    }\n    const roundStartTime = startAction && startAction.length > 0 ? startAction[0].created_at : new Date(0).toISOString();\n    // 각 활성 플레이어별로 마지막 액션 확인\n    for (const player of activePlayers){\n        const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"game_actions\").select(\"player_id\").eq(\"game_id\", gameId).eq(\"player_id\", player.id).in(\"action_type\", [\n            \"bet\",\n            \"call\",\n            \"raise\",\n            \"half\",\n            \"check\",\n            \"die\"\n        ]).gt(\"created_at\", roundStartTime).order(\"created_at\", {\n            ascending: false\n        }).limit(1);\n        if (error || !data || data.length === 0) {\n            return false; // 플레이어가 현재 라운드에서 액션을 취하지 않았음\n        }\n        playerLastActions.add(player.id);\n    }\n    // 모든 활성 플레이어가 액션을 취했는지 확인\n    return playerLastActions.size === activePlayers.length;\n}\n/**\n * 게임 종료 처리\n */ async function finishGame(gameId) {\n    // 게임 상태 조회\n    const gameState = await getGameState(gameId);\n    // 활성 플레이어 (다이하지 않은 플레이어 중 카드가 있는 플레이어)\n    const activePlayers = gameState.players.filter((p)=>!p.isDie && p.cards && p.cards.length === 2).map((p)=>({\n            id: p.id,\n            cards: p.cards,\n            isDie: p.isDie || false\n        }));\n    if (activePlayers.length === 0) {\n        console.error(\"활성 플레이어가 없습니다\");\n        return;\n    }\n    // 승자 결정\n    const { winnerId, isRegame } = (0,_utils_gameLogic__WEBPACK_IMPORTED_MODULE_1__.determineWinner)(activePlayers);\n    // 재경기 처리\n    if (isRegame) {\n        await handleRegame(gameId);\n        return;\n    }\n    if (!winnerId) {\n        console.log(\"승자를 결정할 수 없음 (구사 등의 특수 상황)\");\n        return;\n    }\n    // 승자 찾기\n    const winner = gameState.players.find((p)=>p.id === winnerId);\n    if (!winner) {\n        console.error(\"승자 정보를 찾을 수 없음\");\n        return;\n    }\n    // 땡값 계산 처리\n    let winnings = gameState.bettingValue;\n    let dangValues = {};\n    // 활성 플레이어 중 패자들 확인\n    for (const player of gameState.players.filter((p)=>!p.isDie && p.id !== winnerId)){\n        // 승자 패 확인\n        const winnerEval = (0,_utils_gameLogic__WEBPACK_IMPORTED_MODULE_1__.evaluateCards)(winner.cards || []);\n        // 패자 패 확인\n        const loserEval = (0,_utils_gameLogic__WEBPACK_IMPORTED_MODULE_1__.evaluateCards)(player.cards || []);\n        // 땡값 계산 - 승자가 땡잡이고 패자가 땡일 경우\n        if (winnerEval.rank === \"땡잡이\" && loserEval.rank.includes(\"땡\") && !loserEval.rank.includes(\"광땡\") && loserEval.rank !== \"10땡\") {\n            const dangValue = calculateDangValue(loserEval.rank, gameState.bettingValue);\n            dangValues[player.id] = dangValue;\n            winnings += dangValue;\n        }\n        // 암행어사와 광땡 처리\n        if (winnerEval.rank === \"암행어사\" && (loserEval.rank === \"13광땡\" || loserEval.rank === \"18광땡\")) {\n            // 광땡에 대한 암행어사 배당 (일반적으로 3배)\n            const amhaengValue = gameState.bettingValue * 3;\n            dangValues[player.id] = amhaengValue;\n            winnings += amhaengValue;\n        }\n        // 38광땡이 다른 광땡을 이겼을 경우 (상위 광땡이 하위 광땡 배당)\n        if (winnerEval.rank === \"38광땡\" && (loserEval.rank === \"13광땡\" || loserEval.rank === \"18광땡\")) {\n            const gwangDangValue = gameState.bettingValue * 2;\n            dangValues[player.id] = gwangDangValue;\n            winnings += gwangDangValue;\n        }\n    }\n    // 승자의 잔액 업데이트\n    const { error: winnerUpdateError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"players\").update({\n        balance: winner.balance + winnings\n    }).eq(\"id\", winnerId);\n    if (winnerUpdateError) {\n        console.error(\"승자 잔액 업데이트 오류:\", winnerUpdateError);\n        throw new Error(\"승자 잔액을 업데이트할 수 없습니다.\");\n    }\n    // 땡값이 있다면 패자들의 잔액 추가 차감\n    for (const [playerId, dangValue] of Object.entries(dangValues)){\n        const loser = gameState.players.find((p)=>p.id === playerId);\n        if (loser) {\n            const { error: loserUpdateError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"players\").update({\n                balance: Math.max(0, loser.balance - dangValue) // 최소 0으로 제한\n            }).eq(\"id\", playerId);\n            if (loserUpdateError) {\n                console.error(\"패자 잔액 업데이트 오류:\", loserUpdateError);\n            }\n        }\n    }\n    // 게임 상태 업데이트\n    const { error: gameUpdateError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"games\").update({\n        status: \"finished\",\n        winner: winnerId,\n        show_cards: true,\n        dang_values: dangValues\n    }).eq(\"id\", gameId);\n    if (gameUpdateError) {\n        console.error(\"게임 종료 상태 업데이트 오류:\", gameUpdateError);\n        throw new Error(\"게임을 종료할 수 없습니다.\");\n    }\n    // 결과 액션 기록\n    await recordGameAction(gameId, \"show\", winnerId);\n}\n// 땡값 계산 함수\nfunction calculateDangValue(rank, bettingValue) {\n    // 광땡 배당\n    if (rank === \"38광땡\") return bettingValue * 10;\n    if (rank === \"13광땡\") return bettingValue * 8;\n    if (rank === \"18광땡\") return bettingValue * 7;\n    // 일반 땡 배당\n    if (rank === \"10땡\" || rank === \"장땡\") return bettingValue * 5;\n    if (rank === \"9땡\") return bettingValue * 4.5;\n    if (rank === \"8땡\") return bettingValue * 4;\n    if (rank === \"7땡\") return bettingValue * 3.5;\n    if (rank === \"6땡\") return bettingValue * 3;\n    if (rank === \"5땡\") return bettingValue * 2.5;\n    if (rank === \"4땡\") return bettingValue * 2;\n    if (rank === \"3땡\") return bettingValue * 1.5;\n    if (rank === \"2땡\") return bettingValue * 1.25;\n    if (rank === \"1땡\") return bettingValue * 1;\n    // 특수 조합 배당\n    if (rank === \"암행어사\") return bettingValue * 3; // 광땡 잡았을 때\n    return 0; // 땡이 아닌 경우\n}\n// 재경기 처리 함수\nasync function handleRegame(gameId) {\n    const gameState = await getGameState(gameId);\n    // 플레이어들 카드 초기화 \n    for (const player of gameState.players){\n        const { error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"players\").update({\n            cards: null,\n            is_die: false\n        }).eq(\"id\", player.id);\n        if (error) {\n            console.error(\"플레이어 카드 초기화 오류:\", error);\n        }\n    }\n    // 게임 상태 업데이트 - 배팅값은 유지하며 재시작\n    const { error: gameUpdateError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"games\").update({\n        status: \"regame\",\n        current_turn: null,\n        winner: null,\n        regame_start_time: new Date().toISOString(),\n        regame_wait_time: REGAME_WAIT_TIME_MS\n    }).eq(\"id\", gameId);\n    if (gameUpdateError) {\n        console.error(\"재경기 설정 오류:\", gameUpdateError);\n        throw new Error(\"재경기를 설정할 수 없습니다.\");\n    }\n    // 재경기 액션 기록\n    await recordGameAction(gameId, \"regame\", null);\n    // 1초마다 대기 시간 업데이트\n    let remainingTime = Math.floor(REGAME_WAIT_TIME_MS / 1000);\n    const intervalId = setInterval(async ()=>{\n        remainingTime--;\n        // 남은 시간 업데이트\n        await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"games\").update({\n            regame_remaining_time: remainingTime\n        }).eq(\"id\", gameId);\n        if (remainingTime <= 0) {\n            clearInterval(intervalId);\n        }\n    }, 1000);\n    // 잠시 후 게임 재시작\n    setTimeout(async ()=>{\n        try {\n            clearInterval(intervalId); // 혹시 남아있는 인터벌 정리\n            await startGame(gameId);\n        } catch (err) {\n            console.error(\"재경기 시작 오류:\", err);\n        }\n    }, REGAME_WAIT_TIME_MS);\n}\n// 플레이어 좌석 업데이트\nasync function updateSeat(gameId, playerId, seatIndex) {\n    try {\n        // 해당 좌석이 이미 사용 중인지 확인\n        const { data: existingPlayer, error: checkError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"players\").select(\"id\").eq(\"game_id\", gameId).eq(\"seat_index\", seatIndex);\n        if (checkError) {\n            console.error(\"좌석 확인 오류:\", checkError);\n            throw new Error(\"좌석 정보를 확인할 수 없습니다.\");\n        }\n        // 이미 다른 플레이어가 해당 좌석에 앉아있으면 오류\n        if (existingPlayer && existingPlayer.length > 0 && existingPlayer[0].id !== playerId) {\n            throw new Error(\"이미 다른 플레이어가 사용 중인 좌석입니다.\");\n        }\n        // 플레이어 좌석 업데이트\n        const { error: updateError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"players\").update({\n            seat_index: seatIndex\n        }).eq(\"game_id\", gameId).eq(\"id\", playerId);\n        if (updateError) {\n            console.error(\"좌석 업데이트 오류:\", updateError);\n            throw new Error(\"좌석을 업데이트할 수 없습니다: \" + updateError.message);\n        }\n    } catch (err) {\n        console.error(\"좌석 업데이트 중 예외 발생:\", err);\n        throw err;\n    }\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFJLENBQUMsV0FDTE8sTUFBTSxDQUFDLE1BQ1BRLEVBQUUsQ0FBQyxXQUFXMUIsUUFDZDBCLEVBQUUsQ0FBQyxjQUFjRDtRQUVwQixJQUFJMkksWUFBWTtZQUNkakosUUFBUVYsS0FBSyxDQUFDLGFBQWEySjtZQUMzQixNQUFNLElBQUloSixNQUFNO1FBQ2xCO1FBRUEsOEJBQThCO1FBQzlCLElBQUlZLGtCQUFrQkEsZUFBZXFDLE1BQU0sR0FBRyxLQUFLckMsY0FBYyxDQUFDLEVBQUUsQ0FBQ25CLEVBQUUsS0FBS1osVUFBVTtZQUNwRixNQUFNLElBQUltQixNQUFNO1FBQ2xCO1FBRUEsZUFBZTtRQUNmLE1BQU0sRUFBRVgsT0FBT29FLFdBQVcsRUFBRSxHQUFHLE1BQU1yRiwrQ0FBUUEsQ0FDMUNtQixJQUFJLENBQUMsV0FDTHVCLE1BQU0sQ0FBQztZQUFFVSxZQUFZbkI7UUFBVSxHQUMvQkMsRUFBRSxDQUFDLFdBQVcxQixRQUNkMEIsRUFBRSxDQUFDLE1BQU16QjtRQUVaLElBQUk0RSxhQUFhO1lBQ2YxRCxRQUFRVixLQUFLLENBQUMsZUFBZW9FO1lBQzdCLE1BQU0sSUFBSXpELE1BQU0sdUJBQXVCeUQsWUFBWXhELE9BQU87UUFDNUQ7SUFDRixFQUFFLE9BQU9FLEtBQUs7UUFDWkosUUFBUVYsS0FBSyxDQUFDLG9CQUFvQmM7UUFDbEMsTUFBTUE7SUFDUjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL3NyYy9saWIvZ2FtZUFwaS50cz81NDg1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHN1cGFiYXNlIH0gZnJvbSAnLi9zdXBhYmFzZSc7XG5pbXBvcnQgeyBHYW1lU3RhdGUsIENyZWF0ZUdhbWVSZXNwb25zZSwgSm9pbkdhbWVSZXNwb25zZSwgQmV0QWN0aW9uVHlwZSB9IGZyb20gJ0AvdHlwZXMvZ2FtZSc7XG5pbXBvcnQgeyB2NCBhcyB1dWlkdjQgfSBmcm9tICd1dWlkJztcbmltcG9ydCB7IGRldGVybWluZVdpbm5lciwgZXZhbHVhdGVDYXJkcyB9IGZyb20gJ0AvdXRpbHMvZ2FtZUxvZ2ljJztcbmltcG9ydCB7IFBsYXllciB9IGZyb20gJ0AvdHlwZXMvZ2FtZSc7XG5cbi8vIOyDgeyImCDsoJXsnZggKO2MjOydvCDsg4Hri6jsl5Ag7LaU6rCAKVxuY29uc3QgUkVHQU1FX1dBSVRfVElNRV9NUyA9IDUwMDA7IC8vIOyerOqyveq4sCDrjIDquLAg7Iuc6rCEICg17LSIKVxuXG4vKipcbiAqIOyDiOuhnOyatCDqsozsnoQg7IOd7ISxXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVHYW1lKHVzZXJuYW1lOiBzdHJpbmcpOiBQcm9taXNlPENyZWF0ZUdhbWVSZXNwb25zZT4ge1xuICBjb25zdCBnYW1lSWQgPSB1dWlkdjQoKTtcbiAgY29uc3QgcGxheWVySWQgPSB1dWlkdjQoKTtcbiAgLy8g7J6E7IucIOyCrOyaqeyekCBJRCDsg53shLFcbiAgY29uc3QgdXNlcklkID0gYHVzZXJfJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoMiwgOSl9YDtcbiAgXG4gIHRyeSB7XG4gICAgLy8g6rKM7J6EIOyDneyEsVxuICAgIGNvbnN0IHsgZGF0YTogZ2FtZURhdGEsIGVycm9yOiBnYW1lRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnZ2FtZXMnKVxuICAgICAgLmluc2VydCh7XG4gICAgICAgIGlkOiBnYW1lSWQsXG4gICAgICAgIHN0YXR1czogJ3dhaXRpbmcnLFxuICAgICAgICBjdXJyZW50X3R1cm46IG51bGwsXG4gICAgICAgIGJldHRpbmdfdmFsdWU6IDAsXG4gICAgICAgIHdpbm5lcjogbnVsbFxuICAgICAgfSlcbiAgICAgIC5zZWxlY3QoKTtcbiAgICBcbiAgICBpZiAoZ2FtZUVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfqsozsnoQg7IOd7ISxIOyYpOulmCDshLjrtoAg7KCV67O0OicsIGdhbWVFcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ+qyjOyehOydhCDsg53shLHtlaAg7IiYIOyXhuyKteuLiOuLpDogJyArIGdhbWVFcnJvci5tZXNzYWdlKTtcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coJ+qyjOyehCDsg53shLEg7ISx6rO1OicsIGdhbWVJZCk7XG4gICAgXG4gICAgLy8g6rSA7LCw7J6QIOuqqOuTnOuhnCDsi5zsnpHtlZjrr4DroZwg7ZSM66CI7J207Ja066W8IOyDneyEse2VmOyngCDslYrsnYxcbiAgICAvLyDtgbTrnbzsnbTslrjtirjripQg67mIIOyekOumrOulvCDtgbTrpq3tlbQg7LC47Jes7ZW07JW8IO2VqFxuICAgIFxuICAgIHJldHVybiB7IGdhbWVJZCwgcGxheWVySWQ6IG51bGwgfTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgY29uc29sZS5lcnJvcign6rKM7J6EIOyDneyEsSDspJEg7JiI7Jm4IOuwnOyDnTonLCBlcnIpO1xuICAgIHRocm93IGVycjtcbiAgfVxufVxuXG4vKipcbiAqIOq4sOyhtCDqsozsnoTsl5Ag7LC46rCAXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBqb2luR2FtZShcbiAgZ2FtZUlkOiBzdHJpbmcsIFxuICB1c2VybmFtZTogc3RyaW5nLCBcbiAgc2VhdEluZGV4PzogbnVtYmVyXG4pOiBQcm9taXNlPEpvaW5HYW1lUmVzcG9uc2U+IHtcbiAgdHJ5IHtcbiAgICAvLyDqsozsnoQg7IOB7YOcIOyytO2BrFxuICAgIGNvbnN0IHsgZGF0YTogZ2FtZURhdGEsIGVycm9yOiBnYW1lRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnZ2FtZXMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuZXEoJ2lkJywgZ2FtZUlkKVxuICAgICAgLnNpbmdsZSgpO1xuXG4gICAgaWYgKGdhbWVFcnJvciB8fCAhZ2FtZURhdGEpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+qyjOyehCDsobDtmowg7Jik66WYIOyEuOu2gCDsoJXrs7Q6JywgZ2FtZUVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcign6rKM7J6E7J2EIOywvuydhCDsiJgg7JeG7Iq164uI64ukOiAnICsgKGdhbWVFcnJvcj8ubWVzc2FnZSB8fCAn7JWMIOyImCDsl4bripQg7Jik66WYJykpO1xuICAgIH1cbiAgICBcbiAgICAvLyDroZzsu6wg7Iqk7Yag66as7KeA7JeQ7IScIOyCrOyaqeyekCBJROyZgCDtlIzroIjsnbTslrQgSUQg7ZmV7J24XG4gICAgY29uc3Qgc3RvcmVkVXNlcklkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oYGdhbWVfJHtnYW1lSWR9X3VzZXJfaWRgKTtcbiAgICBjb25zdCBzdG9yZWRQbGF5ZXJJZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGBnYW1lXyR7Z2FtZUlkfV9wbGF5ZXJfaWRgKTtcbiAgICBcbiAgICAvLyDquLDsobQg7LC47Jes7J6Q7J247KeAIO2ZleyduFxuICAgIGlmIChzdG9yZWRVc2VySWQgJiYgc3RvcmVkUGxheWVySWQpIHtcbiAgICAgIC8vIOq4sOyhtCDtlIzroIjsnbTslrQg7KCV67O0IOyhsO2ajFxuICAgICAgY29uc3QgeyBkYXRhOiBleGlzdGluZ1BsYXllciwgZXJyb3I6IGV4aXN0aW5nUGxheWVyRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdwbGF5ZXJzJylcbiAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgIC5lcSgnZ2FtZV9pZCcsIGdhbWVJZClcbiAgICAgICAgLmVxKCdpZCcsIHN0b3JlZFBsYXllcklkKVxuICAgICAgICAuc2luZ2xlKCk7XG4gICAgICBcbiAgICAgIGlmICghZXhpc3RpbmdQbGF5ZXJFcnJvciAmJiBleGlzdGluZ1BsYXllcikge1xuICAgICAgICBjb25zb2xlLmxvZygn6riw7KG0IO2UjOugiOydtOyWtOuhnCDsnqzsoJHsho06JywgZXhpc3RpbmdQbGF5ZXIuaWQpO1xuICAgICAgICBcbiAgICAgICAgLy8g7J2066aEIOyXheuNsOydtO2KuOqwgCDtlYTsmpTtlZwg6rK97JqwXG4gICAgICAgIGlmIChleGlzdGluZ1BsYXllci51c2VybmFtZSAhPT0gdXNlcm5hbWUpIHtcbiAgICAgICAgICBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAgICAgLmZyb20oJ3BsYXllcnMnKVxuICAgICAgICAgICAgLnVwZGF0ZSh7IHVzZXJuYW1lIH0pXG4gICAgICAgICAgICAuZXEoJ2lkJywgZXhpc3RpbmdQbGF5ZXIuaWQpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyDstZzsi6Ag6rKM7J6EIOyDge2DnCDqsIDsoLjsmKTquLBcbiAgICAgICAgY29uc3QgZ2FtZVN0YXRlID0gYXdhaXQgZ2V0R2FtZVN0YXRlKGdhbWVJZCk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4geyBcbiAgICAgICAgICBwbGF5ZXJJZDogZXhpc3RpbmdQbGF5ZXIuaWQsIFxuICAgICAgICAgIGdhbWVTdGF0ZSxcbiAgICAgICAgICByZWpvaW5lZDogdHJ1ZVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyDsg4gg7ZSM66CI7J207Ja0IOywuOqwgCAo6rKM7J6E7J20IOuMgOq4sCDspJHsnbwg65WM66eMKVxuICAgIGlmIChnYW1lRGF0YS5zdGF0dXMgIT09ICd3YWl0aW5nJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCfsnbTrr7gg7Iuc7J6R65CcIOqyjOyehOyXkOuKlCDssLjqsIDtlaAg7IiYIOyXhuyKteuLiOuLpC4nKTtcbiAgICB9XG4gICAgXG4gICAgY29uc3QgcGxheWVySWQgPSB1dWlkdjQoKTtcbiAgICAvLyDsnoTsi5wg7IKs7Jqp7J6QIElEIOyDneyEsVxuICAgIGNvbnN0IHVzZXJJZCA9IGB1c2VyXyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIsIDkpfWA7XG4gICAgXG4gICAgLy8g7ZSM66CI7J207Ja0IOyDneyEsVxuICAgIGNvbnN0IHsgZGF0YTogcGxheWVyRGF0YSwgZXJyb3I6IHBsYXllckVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3BsYXllcnMnKVxuICAgICAgLmluc2VydCh7XG4gICAgICAgIGlkOiBwbGF5ZXJJZCxcbiAgICAgICAgZ2FtZV9pZDogZ2FtZUlkLFxuICAgICAgICB1c2VyX2lkOiB1c2VySWQsXG4gICAgICAgIHVzZXJuYW1lLFxuICAgICAgICBiYWxhbmNlOiAxMDAwMCxcbiAgICAgICAgaXNfZGllOiBmYWxzZSxcbiAgICAgICAgc2VhdF9pbmRleDogc2VhdEluZGV4XG4gICAgICB9KVxuICAgICAgLnNlbGVjdCgpO1xuICAgIFxuICAgIGlmIChwbGF5ZXJFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign7ZSM66CI7J207Ja0IOyDneyEsSDsmKTrpZgg7IS467aAIOygleuztDonLCBwbGF5ZXJFcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ+qyjOyehOyXkCDssLjqsIDtlaAg7IiYIOyXhuyKteuLiOuLpDogJyArIHBsYXllckVycm9yLm1lc3NhZ2UpO1xuICAgIH1cbiAgICBcbiAgICBjb25zb2xlLmxvZygn7ZSM66CI7J207Ja0IOywuOqwgCDshLHqs7U6JywgcGxheWVySWQpO1xuICAgIFxuICAgIC8vIOuhnOy7rCDsiqTthqDrpqzsp4Dsl5Ag7IKs7Jqp7J6QIOygleuztCDsoIDsnqVcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShgZ2FtZV8ke2dhbWVJZH1fdXNlcl9pZGAsIHVzZXJJZCk7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oYGdhbWVfJHtnYW1lSWR9X3BsYXllcl9pZGAsIHBsYXllcklkKTtcbiAgICBcbiAgICAvLyDstZzsi6Ag6rKM7J6EIOyDge2DnCDqsIDsoLjsmKTquLBcbiAgICBjb25zdCBnYW1lU3RhdGUgPSBhd2FpdCBnZXRHYW1lU3RhdGUoZ2FtZUlkKTtcbiAgICBcbiAgICByZXR1cm4geyBwbGF5ZXJJZCwgZ2FtZVN0YXRlIH07XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+qyjOyehCDssLjqsIAg7KSRIOyYiOyZuCDrsJzsg506JywgZXJyKTtcbiAgICB0aHJvdyBlcnI7XG4gIH1cbn1cblxuLyoqXG4gKiDqsozsnoQg7IOB7YOcIOyhsO2ajFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0R2FtZVN0YXRlKGdhbWVJZDogc3RyaW5nKTogUHJvbWlzZTxHYW1lU3RhdGU+IHtcbiAgLy8g6rKM7J6EIOygleuztCDqsIDsoLjsmKTquLBcbiAgY29uc3QgeyBkYXRhOiBnYW1lRGF0YSwgZXJyb3I6IGdhbWVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbSgnZ2FtZXMnKVxuICAgIC5zZWxlY3QoJyonKVxuICAgIC5lcSgnaWQnLCBnYW1lSWQpXG4gICAgLnNpbmdsZSgpO1xuXG4gIGlmIChnYW1lRXJyb3IgfHwgIWdhbWVEYXRhKSB7XG4gICAgY29uc29sZS5lcnJvcign6rKM7J6EIOyhsO2ajCDsmKTrpZg6JywgZ2FtZUVycm9yKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ+qyjOyehOydhCDssL7snYQg7IiYIOyXhuyKteuLiOuLpC4nKTtcbiAgfVxuICBcbiAgLy8g7ZSM66CI7J207Ja0IOygleuztCDqsIDsoLjsmKTquLBcbiAgY29uc3QgeyBkYXRhOiBwbGF5ZXJzRGF0YSwgZXJyb3I6IHBsYXllcnNFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbSgncGxheWVycycpXG4gICAgLnNlbGVjdCgnKicpXG4gICAgLmVxKCdnYW1lX2lkJywgZ2FtZUlkKTtcbiAgXG4gIGlmIChwbGF5ZXJzRXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCftlIzroIjsnbTslrQg7KGw7ZqMIOyYpOulmDonLCBwbGF5ZXJzRXJyb3IpO1xuICAgIHRocm93IG5ldyBFcnJvcign7ZSM66CI7J207Ja0IOygleuztOulvCDrtojrn6zsmKwg7IiYIOyXhuyKteuLiOuLpC4nKTtcbiAgfVxuICBcbiAgLy8g7J6s6rK96riwIOuCqOydgCDsi5zqsIQg6rOE7IKwXG4gIGxldCByZWdhbWVSZW1haW5pbmdUaW1lOiBudW1iZXIgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XG4gIGlmIChnYW1lRGF0YS5zdGF0dXMgPT09ICdyZWdhbWUnICYmIGdhbWVEYXRhLnJlZ2FtZV9zdGFydF90aW1lICYmIGdhbWVEYXRhLnJlZ2FtZV93YWl0X3RpbWUpIHtcbiAgICBjb25zdCBzdGFydFRpbWUgPSBuZXcgRGF0ZShnYW1lRGF0YS5yZWdhbWVfc3RhcnRfdGltZSkuZ2V0VGltZSgpO1xuICAgIGNvbnN0IGN1cnJlbnRUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgY29uc3QgZWxhcHNlZE1zID0gY3VycmVudFRpbWUgLSBzdGFydFRpbWU7XG4gICAgY29uc3QgcmVtYWluaW5nTXMgPSBNYXRoLm1heCgwLCBnYW1lRGF0YS5yZWdhbWVfd2FpdF90aW1lIC0gZWxhcHNlZE1zKTtcbiAgICByZWdhbWVSZW1haW5pbmdUaW1lID0gTWF0aC5jZWlsKHJlbWFpbmluZ01zIC8gMTAwMCk7XG4gIH1cbiAgXG4gIC8vIOqyjOyehCDsg4Htg5wg7KCV67O0IO2PrOunt+2MhVxuICBjb25zdCBnYW1lU3RhdGU6IEdhbWVTdGF0ZSA9IHtcbiAgICBpZDogZ2FtZURhdGEuaWQsXG4gICAgc3RhdHVzOiBnYW1lRGF0YS5zdGF0dXMsXG4gICAgcGxheWVyczogcGxheWVyc0RhdGEubWFwKHBsYXllciA9PiAoe1xuICAgICAgaWQ6IHBsYXllci5pZCxcbiAgICAgIHVzZXJfaWQ6IHBsYXllci51c2VyX2lkLFxuICAgICAgdXNlcm5hbWU6IHBsYXllci51c2VybmFtZSxcbiAgICAgIGJhbGFuY2U6IHBsYXllci5iYWxhbmNlLFxuICAgICAgY2FyZHM6IHBsYXllci5jYXJkcyB8fCBbXSxcbiAgICAgIGlzRGllOiBwbGF5ZXIuaXNfZGllXG4gICAgfSkpLFxuICAgIGN1cnJlbnRUdXJuOiBnYW1lRGF0YS5jdXJyZW50X3R1cm4gfHwgJycsXG4gICAgd2lubmVyOiBnYW1lRGF0YS53aW5uZXIsXG4gICAgYmV0dGluZ1ZhbHVlOiBnYW1lRGF0YS5iZXR0aW5nX3ZhbHVlLFxuICAgIHJlZ2FtZV9yZW1haW5pbmdfdGltZTogcmVnYW1lUmVtYWluaW5nVGltZSxcbiAgICByZWdhbWVfc3RhcnRfdGltZTogZ2FtZURhdGEucmVnYW1lX3N0YXJ0X3RpbWVcbiAgfTtcbiAgXG4gIHJldHVybiBnYW1lU3RhdGU7XG59XG5cbi8qKlxuICog6rKM7J6EIOyLnOyekVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3RhcnRHYW1lKGdhbWVJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gIC8vIOqyjOyehCDrsI8g7ZSM66CI7J207Ja0IOygleuztCDqsIDsoLjsmKTquLBcbiAgY29uc3QgeyBkYXRhOiBwbGF5ZXJzRGF0YSwgZXJyb3I6IHBsYXllcnNFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbSgncGxheWVycycpXG4gICAgLnNlbGVjdCgnaWQnKVxuICAgIC5lcSgnZ2FtZV9pZCcsIGdhbWVJZCk7XG5cbiAgaWYgKHBsYXllcnNFcnJvciB8fCAhcGxheWVyc0RhdGEgfHwgcGxheWVyc0RhdGEubGVuZ3RoIDwgMikge1xuICAgIHRocm93IG5ldyBFcnJvcign7LWc7IaMIDLrqoXsnZgg7ZSM66CI7J207Ja06rCAIO2VhOyalO2VqeuLiOuLpC4nKTtcbiAgfVxuICBcbiAgLy8g7Lm065OcIOuNsSDsg53shLEg67CPIOyFlO2UjFxuICBjb25zdCBkZWNrID0gY3JlYXRlU2h1ZmZsZWREZWNrKCk7XG4gIFxuICAvLyDtlIzroIjsnbTslrTrk6Tsl5Dqsowg7Lm065OcIOuwsOu2hCDrsI8g7JeF642w7J207Yq4XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgcGxheWVyc0RhdGEubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBwbGF5ZXJDYXJkcyA9IFtkZWNrLnBvcCgpLCBkZWNrLnBvcCgpXS5maWx0ZXIoQm9vbGVhbikgYXMgbnVtYmVyW107XG4gICAgXG4gICAgY29uc3QgeyBlcnJvcjogdXBkYXRlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgncGxheWVycycpXG4gICAgICAudXBkYXRlKHsgY2FyZHM6IHBsYXllckNhcmRzIH0pXG4gICAgICAuZXEoJ2lkJywgcGxheWVyc0RhdGFbaV0uaWQpO1xuICAgIFxuICAgIGlmICh1cGRhdGVFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign7ZSM66CI7J207Ja0IOy5tOuTnCDsl4XrjbDsnbTtirgg7Jik66WYOicsIHVwZGF0ZUVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcign7Lm065Oc66W8IOuwsOu2hO2VoCDsiJgg7JeG7Iq164uI64ukLicpO1xuICAgIH1cbiAgfVxuICBcbiAgLy8g7LKrIO2EtOydhCDrnpzrjaTsnLzroZwg7ISg7YOdXG4gIGNvbnN0IGZpcnN0VHVybiA9IHBsYXllcnNEYXRhW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHBsYXllcnNEYXRhLmxlbmd0aCldLmlkO1xuICBcbiAgLy8g6rKM7J6EIOyDge2DnCDsl4XrjbDsnbTtirhcbiAgY29uc3QgeyBlcnJvcjogdXBkYXRlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgLmZyb20oJ2dhbWVzJylcbiAgICAudXBkYXRlKHtcbiAgICAgIHN0YXR1czogJ3BsYXlpbmcnLFxuICAgICAgY3VycmVudF90dXJuOiBmaXJzdFR1cm4sXG4gICAgICBiZXR0aW5nX3ZhbHVlOiAwXG4gICAgfSlcbiAgICAuZXEoJ2lkJywgZ2FtZUlkKTtcbiAgXG4gIGlmICh1cGRhdGVFcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+qyjOyehCDsg4Htg5wg7JeF642w7J207Yq4IOyYpOulmDonLCB1cGRhdGVFcnJvcik7XG4gICAgdGhyb3cgbmV3IEVycm9yKCfqsozsnoTsnYQg7Iuc7J6R7ZWgIOyImCDsl4bsirXri4jri6QuJyk7XG4gIH1cbiAgXG4gIC8vIOqyjOyehCDsi5zsnpEg7JWh7IWYIOq4sOuhnVxuICBhd2FpdCByZWNvcmRHYW1lQWN0aW9uKGdhbWVJZCwgJ3N0YXJ0JywgZmlyc3RUdXJuKTtcbn1cblxuLyoqXG4gKiDrsqDtjIVcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHBsYWNlQmV0KFxuICBnYW1lSWQ6IHN0cmluZywgXG4gIHBsYXllcklkOiBzdHJpbmcsIFxuICBhY3Rpb25UeXBlOiBCZXRBY3Rpb25UeXBlLCBcbiAgYW1vdW50PzogbnVtYmVyXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgLy8g6rKM7J6EIOyDge2DnCDtmZXsnbhcbiAgY29uc3QgZ2FtZVN0YXRlID0gYXdhaXQgZ2V0R2FtZVN0YXRlKGdhbWVJZCk7XG4gIFxuICBpZiAoZ2FtZVN0YXRlLnN0YXR1cyAhPT0gJ3BsYXlpbmcnKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCfqsozsnoTsnbQg7KeE7ZaJIOykkeydtCDslYTri5nri4jri6QuJyk7XG4gIH1cbiAgXG4gIGlmIChnYW1lU3RhdGUuY3VycmVudFR1cm4gIT09IHBsYXllcklkKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCfri7nsi6DsnZgg7YS07J20IOyVhOuLmeuLiOuLpC4nKTtcbiAgfVxuICBcbiAgY29uc3QgcGxheWVyID0gZ2FtZVN0YXRlLnBsYXllcnMuZmluZChwID0+IHAuaWQgPT09IHBsYXllcklkKTtcbiAgaWYgKCFwbGF5ZXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ+2UjOugiOydtOyWtOulvCDssL7snYQg7IiYIOyXhuyKteuLiOuLpC4nKTtcbiAgfVxuXG4gIC8vIOy1nOq3vCDrsLDtjIUg7JWh7IWYIOyhsO2ajFxuICBjb25zdCB7IGRhdGE6IGFjdGlvbnNEYXRhLCBlcnJvcjogYWN0aW9uc0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKCdnYW1lX2FjdGlvbnMnKVxuICAgIC5zZWxlY3QoJyonKVxuICAgIC5lcSgnZ2FtZV9pZCcsIGdhbWVJZClcbiAgICAub3JkZXIoJ2NyZWF0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcbiAgICAubGltaXQoMTApO1xuXG4gIGlmIChhY3Rpb25zRXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfqsozsnoQg7JWh7IWYIOyhsO2ajCDsmKTrpZg6JywgYWN0aW9uc0Vycm9yKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ+qyjOyehCDslaHshZjsnYQg7KGw7ZqM7ZWgIOyImCDsl4bsirXri4jri6QuJyk7XG4gIH1cblxuICAvLyDrp4jsp4Drp4kg67Cw7YyFIOyVoeyFmCDssL7quLBcbiAgY29uc3QgbGFzdEJldEFjdGlvbiA9IGFjdGlvbnNEYXRhPy5maW5kKGFjdGlvbiA9PiBcbiAgICBbJ2JldCcsICdyYWlzZScsICdjYWxsJywgJ2hhbGYnXS5pbmNsdWRlcyhhY3Rpb24uYWN0aW9uX3R5cGUpICYmIFxuICAgIGFjdGlvbi5wbGF5ZXJfaWQgIT09IHBsYXllcklkXG4gICk7XG5cbiAgLy8g7JWh7IWYIOuzhCDrsLDtjIUg6riI7JWhIOqzhOyCsFxuICBsZXQgYmV0QW1vdW50ID0gMDtcbiAgY29uc3QgYmFzZUJldCA9IGdhbWVTdGF0ZS5iYXNlQmV0IHx8IDUwMDsgLy8g6riw67O4IOuwsO2MheyVoVxuICBcbiAgc3dpdGNoIChhY3Rpb25UeXBlKSB7XG4gICAgY2FzZSAnY2hlY2snOlxuICAgICAgLy8g7J207KCEIOuyoO2MheydtCDsl4bsnYQg65WM66eMIOqwgOuKpVxuICAgICAgaWYgKGxhc3RCZXRBY3Rpb24gJiYgbGFzdEJldEFjdGlvbi5hbW91bnQgPiAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcign7J207KCEIOuyoO2MheydtCDsnojslrQg7LK07YGs7ZWgIOyImCDsl4bsirXri4jri6QuJyk7XG4gICAgICB9XG4gICAgICBiZXRBbW91bnQgPSAwO1xuICAgICAgYnJlYWs7XG4gICAgICBcbiAgICBjYXNlICdjYWxsJzpcbiAgICAgIC8vIOydtOyghCDrsqDtjIXslaHqs7wg64+Z7J287ZWY6rKMXG4gICAgICBiZXRBbW91bnQgPSBsYXN0QmV0QWN0aW9uPy5hbW91bnQgfHwgYmFzZUJldDtcbiAgICAgIGJyZWFrO1xuICAgICAgXG4gICAgY2FzZSAnaGFsZic6XG4gICAgICAvLyDtjJ/snZgg7KCI67CYXG4gICAgICBiZXRBbW91bnQgPSBNYXRoLmZsb29yKGdhbWVTdGF0ZS5iZXR0aW5nVmFsdWUgLyAyKTtcbiAgICAgIC8vIOy1nOyGjCDquLDrs7gg67Cw7YyF7JWhIOuztOyepVxuICAgICAgYmV0QW1vdW50ID0gYmV0QW1vdW50IDwgYmFzZUJldCA/IGJhc2VCZXQgOiBiZXRBbW91bnQ7XG4gICAgICBicmVhaztcbiAgICAgIFxuICAgIGNhc2UgJ2JldCc6XG4gICAgY2FzZSAncmFpc2UnOlxuICAgICAgLy8g7IKs7Jqp7J6Q6rCAIOyngOygle2VnCDquIjslaFcbiAgICAgIGlmICghYW1vdW50IHx8IGFtb3VudCA8PSAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcign67Kg7YyFIOq4iOyVoeydgCAw67O064ukIOy7pOyVvCDtlanri4jri6QuJyk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOy1nOyGjCDrsqDtjIXslaEg7ZmV7J24XG4gICAgICBjb25zdCBtaW5CZXQgPSBsYXN0QmV0QWN0aW9uID8gbGFzdEJldEFjdGlvbi5hbW91bnQgKiAyIDogYmFzZUJldDtcbiAgICAgIGlmIChhbW91bnQgPCBtaW5CZXQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGDstZzshowg67Kg7YyF7JWh7J2AICR7bWluQmV0feyeheuLiOuLpC5gKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8g7LWc64yAIOuyoO2MheyVoSAo7Jis7J24IOydtOyZuCnsnYAg67O07Jyg65+JXG4gICAgICBiZXRBbW91bnQgPSBhbW91bnQ7XG4gICAgICBicmVhaztcbiAgICAgIFxuICAgIGNhc2UgJ2RpZSc6XG4gICAgICAvLyDri6TsnbTripQg67mE7JqpIOyXhuydjFxuICAgICAgYmV0QW1vdW50ID0gMDtcbiAgICAgIGJyZWFrO1xuICAgICAgXG4gICAgZGVmYXVsdDpcbiAgICAgIHRocm93IG5ldyBFcnJvcign7J6Y66q765CcIOyVoeyFmCDtg4DsnoXsnoXri4jri6QuJyk7XG4gIH1cbiAgXG4gIC8vIOyelOyVoSDtmZXsnbhcbiAgaWYgKGFjdGlvblR5cGUgIT09ICdkaWUnICYmIHBsYXllci5iYWxhbmNlIDwgYmV0QW1vdW50KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCfsnpTslaHsnbQg67aA7KGx7ZWp64uI64ukLicpO1xuICB9XG4gIFxuICAvLyDslaHshZgg7LKY66asXG4gIGlmIChhY3Rpb25UeXBlID09PSAnZGllJykge1xuICAgIC8vIO2UjOugiOydtOyWtOulvCDri6TsnbQg7IOB7YOc66GcIOuzgOqyvVxuICAgIGNvbnN0IHsgZXJyb3I6IHBsYXllclVwZGF0ZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3BsYXllcnMnKVxuICAgICAgLnVwZGF0ZSh7XG4gICAgICAgIGlzX2RpZTogdHJ1ZVxuICAgICAgfSlcbiAgICAgIC5lcSgnaWQnLCBwbGF5ZXJJZCk7XG4gICAgXG4gICAgaWYgKHBsYXllclVwZGF0ZUVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCftlIzroIjsnbTslrQg64uk7J20IOyDge2DnCDsl4XrjbDsnbTtirgg7Jik66WYOicsIHBsYXllclVwZGF0ZUVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcign64uk7J207ZWgIOyImCDsl4bsirXri4jri6QuJyk7XG4gICAgfVxuICAgIFxuICAgIC8vIOuCqOydgCDtlIzroIjsnbTslrQg7ZmV7J24XG4gICAgY29uc3QgYWN0aXZlUGxheWVycyA9IGdhbWVTdGF0ZS5wbGF5ZXJzLmZpbHRlcihwID0+IHAuaWQgIT09IHBsYXllcklkICYmICFwLmlzRGllKTtcbiAgICBcbiAgICBpZiAoYWN0aXZlUGxheWVycy5sZW5ndGggPT09IDEpIHtcbiAgICAgIC8vIO2VnCDrqoXrp4wg64Ko7JWY7Jy866m0IOqyjOyehCDsooXro4xcbiAgICAgIGNvbnN0IHdpbm5lciA9IGFjdGl2ZVBsYXllcnNbMF0uaWQ7XG5cbiAgICAgIC8vIOyKueyekOydmCDsnpTslaEg7JeF642w7J207Yq4XG4gICAgICBjb25zdCB7IGVycm9yOiB3aW5uZXJVcGRhdGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3BsYXllcnMnKVxuICAgICAgICAudXBkYXRlKHtcbiAgICAgICAgICBiYWxhbmNlOiBhY3RpdmVQbGF5ZXJzWzBdLmJhbGFuY2UgKyBnYW1lU3RhdGUuYmV0dGluZ1ZhbHVlXG4gICAgICAgIH0pXG4gICAgICAgIC5lcSgnaWQnLCB3aW5uZXIpO1xuICAgICAgXG4gICAgICBpZiAod2lubmVyVXBkYXRlRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign7Iq57J6QIOyelOyVoSDsl4XrjbDsnbTtirgg7Jik66WYOicsIHdpbm5lclVwZGF0ZUVycm9yKTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCfsirnsnpAg7J6U7JWh7J2EIOyXheuNsOydtO2KuO2VoCDsiJgg7JeG7Iq164uI64ukLicpO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyDqsozsnoQg7KKF66OMIOyDge2DnCDsl4XrjbDsnbTtirhcbiAgICAgIGNvbnN0IHsgZXJyb3I6IGdhbWVVcGRhdGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgICAgIC5mcm9tKCdnYW1lcycpXG4gICAgICAgICAgICAudXBkYXRlKHtcbiAgICAgICAgICAgICAgc3RhdHVzOiAnZmluaXNoZWQnLFxuICAgICAgICAgIHdpbm5lcjogd2lubmVyXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmVxKCdpZCcsIGdhbWVJZCk7XG4gICAgICBcbiAgICAgIGlmIChnYW1lVXBkYXRlRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign6rKM7J6EIOyiheujjCDsg4Htg5wg7JeF642w7J207Yq4IOyYpOulmDonLCBnYW1lVXBkYXRlRXJyb3IpO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ+qyjOyehOydhCDsooXro4ztlaAg7IiYIOyXhuyKteuLiOuLpC4nKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8g7JWh7IWYIOq4sOuhnVxuICAgICAgYXdhaXQgcmVjb3JkR2FtZUFjdGlvbihnYW1lSWQsICdkaWUnLCBwbGF5ZXJJZCk7XG4gICAgICByZXR1cm47XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIOuLpOydjCDtlIzroIjsnbTslrQg6rKw7KCVXG4gICAgICBjb25zdCBuZXh0UGxheWVyVHVybklkID0gZ2V0TmV4dFBsYXllclR1cm4oZ2FtZVN0YXRlLnBsYXllcnMsIHBsYXllcklkKTtcblxuICAgICAgLy8g6rKM7J6EIOyDge2DnCDsl4XrjbDsnbTtirhcbiAgICAgIGNvbnN0IHsgZXJyb3I6IGdhbWVVcGRhdGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2dhbWVzJylcbiAgICAgICAgLnVwZGF0ZSh7XG4gICAgICAgICAgY3VycmVudF90dXJuOiBuZXh0UGxheWVyVHVybklkXG4gICAgICAgIH0pXG4gICAgICAgIC5lcSgnaWQnLCBnYW1lSWQpO1xuICAgICAgXG4gICAgICBpZiAoZ2FtZVVwZGF0ZUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+qyjOyehCDsg4Htg5wg7JeF642w7J207Yq4IOyYpOulmDonLCBnYW1lVXBkYXRlRXJyb3IpO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ+qyjOyehCDsg4Htg5zrpbwg7JeF642w7J207Yq47ZWgIOyImCDsl4bsirXri4jri6QuJyk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOyVoeyFmCDquLDroZ1cbiAgICAgIGF3YWl0IHJlY29yZEdhbWVBY3Rpb24oZ2FtZUlkLCAnZGllJywgcGxheWVySWQpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfVxuICBcbiAgLy8g64uk7J2MIO2UjOugiOydtOyWtCDqsrDsoJVcbiAgY29uc3QgbmV4dFBsYXllclR1cm5JZCA9IGdldE5leHRQbGF5ZXJUdXJuKGdhbWVTdGF0ZS5wbGF5ZXJzLCBwbGF5ZXJJZCk7XG5cbiAgLy8g6rKM7J6EIOyDge2DnCDsl4XrjbDsnbTtirhcbiAgY29uc3QgeyBlcnJvcjogZ2FtZVVwZGF0ZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKCdnYW1lcycpXG4gICAgLnVwZGF0ZSh7XG4gICAgICBjdXJyZW50X3R1cm46IG5leHRQbGF5ZXJUdXJuSWQsXG4gICAgICBiZXR0aW5nX3ZhbHVlOiBnYW1lU3RhdGUuYmV0dGluZ1ZhbHVlICsgYmV0QW1vdW50XG4gICAgfSlcbiAgICAuZXEoJ2lkJywgZ2FtZUlkKTtcbiAgXG4gIGlmIChnYW1lVXBkYXRlRXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfqsozsnoQg7IOB7YOcIOyXheuNsOydtO2KuCDsmKTrpZg6JywgZ2FtZVVwZGF0ZUVycm9yKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ+uyoO2Mhe2VoCDsiJgg7JeG7Iq164uI64ukLicpO1xuICB9XG4gIFxuICAvLyDtlIzroIjsnbTslrQg7J6U7JWhIOyXheuNsOydtO2KuFxuICBpZiAoYmV0QW1vdW50ID4gMCkge1xuICAgIGNvbnN0IHsgZXJyb3I6IHBsYXllclVwZGF0ZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3BsYXllcnMnKVxuICAgICAgLnVwZGF0ZSh7XG4gICAgICAgIGJhbGFuY2U6IHBsYXllci5iYWxhbmNlIC0gYmV0QW1vdW50XG4gICAgICB9KVxuICAgICAgLmVxKCdpZCcsIHBsYXllcklkKTtcbiAgICBcbiAgICBpZiAocGxheWVyVXBkYXRlRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+2UjOugiOydtOyWtCDsnpTslaEg7JeF642w7J207Yq4IOyYpOulmDonLCBwbGF5ZXJVcGRhdGVFcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ+yelOyVoeydhCDsl4XrjbDsnbTtirjtlaAg7IiYIOyXhuyKteuLiOuLpC4nKTtcbiAgICB9XG4gIH1cbiAgXG4gIC8vIOuqqOuToCDtlIzroIjsnbTslrTqsIAg7JWh7IWY7J2EIOy3qO2WiOuKlOyngCDtmZXsnbhcbiAgY29uc3QgYWxsUGxheWVyc1Rvb2tBY3Rpb24gPSBhd2FpdCBjaGVja0FsbFBsYXllcnNIYWRUdXJuKGdhbWVJZCwgZ2FtZVN0YXRlLnBsYXllcnMpO1xuICBjb25zdCBhbGxQbGF5ZXJzTWF0Y2hlZEJldCA9IGF3YWl0IGNoZWNrQWxsUGxheWVyc01hdGNoZWRCZXQoZ2FtZUlkLCBnYW1lU3RhdGUucGxheWVycyk7XG4gIFxuICAvLyDrqqjrk6Ag7ZSM66CI7J207Ja06rCAIOyVoeyFmOydhCDst6jtlojqs6AsIOuwsO2MhSDquIjslaHsnbQg7J287LmY7ZWY66m0IOqyjOyehCDsooXro4xcbiAgaWYgKGFsbFBsYXllcnNUb29rQWN0aW9uICYmIGFsbFBsYXllcnNNYXRjaGVkQmV0KSB7XG4gICAgY29uc29sZS5sb2coJ+uqqOuToCDtlIzroIjsnbTslrQg7JWh7IWYIOyZhOujjCwg67Kg7YyFIOq4iOyVoSDsnbzsuZggLSDqsozsnoQg7KKF66OMJyk7XG4gICAgYXdhaXQgZmluaXNoR2FtZShnYW1lSWQpO1xuICB9IGVsc2Uge1xuICAgIC8vIOuUlOuyhOq3uCDroZzqt7hcbiAgICBpZiAoIWFsbFBsYXllcnNUb29rQWN0aW9uKSB7XG4gICAgICBjb25zb2xlLmxvZygn7JWE7KeBIOuqqOuToCDtlIzroIjsnbTslrTqsIAg7JWh7IWY7J2EIOy3qO2VmOyngCDslYrsnYwnKTtcbiAgICB9XG4gICAgaWYgKCFhbGxQbGF5ZXJzTWF0Y2hlZEJldCkge1xuICAgICAgY29uc29sZS5sb2coJ+2UjOugiOydtOyWtOuTpOydmCDrsqDtjIUg6riI7JWh7J20IOydvOy5mO2VmOyngCDslYrsnYwnKTtcbiAgICB9XG4gIH1cbiAgXG4gIC8vIOyVoeyFmCDquLDroZ1cbiAgYXdhaXQgcmVjb3JkR2FtZUFjdGlvbihnYW1lSWQsIGFjdGlvblR5cGUsIHBsYXllcklkLCBiZXRBbW91bnQpO1xufVxuXG4vLyDrqqjrk6Ag7ZSM66CI7J207Ja06rCAIOuPmeydvO2VnCDquIjslaHsnYQg67Cw7YyF7ZaI64qU7KeAIO2ZleyduFxuYXN5bmMgZnVuY3Rpb24gY2hlY2tBbGxQbGF5ZXJzTWF0Y2hlZEJldChnYW1lSWQ6IHN0cmluZywgcGxheWVyczogUGxheWVyW10pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgY29uc3QgYWN0aXZlUGxheWVycyA9IHBsYXllcnMuZmlsdGVyKHAgPT4gIXAuaXNEaWUpO1xuICBcbiAgaWYgKGFjdGl2ZVBsYXllcnMubGVuZ3RoIDw9IDEpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBcbiAgLy8g6rKM7J6EIOyLnOyekSDsnbTtm4Qg6rCBIO2UjOugiOydtOyWtOuzhCDrp4jsp4Drp4kg67Kg7YyFIOqwgOyguOyYpOq4sFxuICBjb25zdCBwbGF5ZXJMYXN0QmV0czogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xuICBcbiAgZm9yIChjb25zdCBwbGF5ZXIgb2YgYWN0aXZlUGxheWVycykge1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnZ2FtZV9hY3Rpb25zJylcbiAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgLmVxKCdnYW1lX2lkJywgZ2FtZUlkKVxuICAgICAgLmVxKCdwbGF5ZXJfaWQnLCBwbGF5ZXIuaWQpXG4gICAgICAuaW4oJ2FjdGlvbl90eXBlJywgWydiZXQnLCAnY2FsbCcsICdyYWlzZScsICdoYWxmJywgJ2NoZWNrJ10pXG4gICAgICAub3JkZXIoJ2NyZWF0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcbiAgICAgIC5saW1pdCgxKTtcbiAgICAgIFxuICAgIGlmIChlcnJvciB8fCAhZGF0YSB8fCBkYXRhLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIGZhbHNlOyAvLyDrjbDsnbTthLDqsIAg7JeG7Jy866m0IOyVhOyngSDsnbzsuZjtlZjsp4Ag7JWK7J2MXG4gICAgfVxuICAgIFxuICAgIHBsYXllckxhc3RCZXRzW3BsYXllci5pZF0gPSBkYXRhWzBdLmFtb3VudCB8fCAwO1xuICB9XG4gIFxuICAvLyDrsqDtjIXslaHsnbQg66qo65GQIOqwmeydgOyngCDtmZXsnbhcbiAgY29uc3QgYmV0QW1vdW50cyA9IE9iamVjdC52YWx1ZXMocGxheWVyTGFzdEJldHMpO1xuICByZXR1cm4gYmV0QW1vdW50cy5ldmVyeShhbW91bnQgPT4gYW1vdW50ID09PSBiZXRBbW91bnRzWzBdKTtcbn1cblxuLy8g64uk7J2MIO2UjOugiOydtOyWtCDthLQg6rCA7KC47Jik6riwXG5mdW5jdGlvbiBnZXROZXh0UGxheWVyVHVybihwbGF5ZXJzOiBQbGF5ZXJbXSwgY3VycmVudFBsYXllcklkOiBzdHJpbmcpOiBzdHJpbmcge1xuICBjb25zdCBhY3RpdmVQbGF5ZXJzID0gcGxheWVycy5maWx0ZXIocCA9PiAhcC5pc0RpZSk7XG4gIGlmIChhY3RpdmVQbGF5ZXJzLmxlbmd0aCA8PSAxKSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG4gIFxuICBjb25zdCBjdXJyZW50SW5kZXggPSBhY3RpdmVQbGF5ZXJzLmZpbmRJbmRleChwID0+IHAuaWQgPT09IGN1cnJlbnRQbGF5ZXJJZCk7XG4gIGNvbnN0IG5leHRJbmRleCA9IChjdXJyZW50SW5kZXggKyAxKSAlIGFjdGl2ZVBsYXllcnMubGVuZ3RoO1xuICByZXR1cm4gYWN0aXZlUGxheWVyc1tuZXh0SW5kZXhdLmlkO1xufVxuXG4vKipcbiAqIOuplOyLnOyngCDsoITshqFcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlbmRNZXNzYWdlKGdhbWVJZDogc3RyaW5nLCBwbGF5ZXJJZDogc3RyaW5nLCBjb250ZW50OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgaWYgKCFjb250ZW50LnRyaW0oKSkge1xuICAgIHRocm93IG5ldyBFcnJvcign66mU7Iuc7KeAIOuCtOyaqeydtCDruYTslrTsnojsirXri4jri6QuJyk7XG4gIH1cbiAgXG4gIC8vIO2UjOugiOydtOyWtCDsoJXrs7Qg6rCA7KC47Jik6riwXG4gIGNvbnN0IHsgZGF0YTogcGxheWVyRGF0YSwgZXJyb3I6IHBsYXllckVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKCdwbGF5ZXJzJylcbiAgICAuc2VsZWN0KCd1c2VybmFtZSwgdXNlcl9pZCcpXG4gICAgLmVxKCdpZCcsIHBsYXllcklkKVxuICAgIC5zaW5nbGUoKTtcbiAgXG4gIGlmIChwbGF5ZXJFcnJvciB8fCAhcGxheWVyRGF0YSkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+2UjOugiOydtOyWtCDsoJXrs7Qg7KGw7ZqMIOyYpOulmDonLCBwbGF5ZXJFcnJvcik7XG4gICAgdGhyb3cgbmV3IEVycm9yKCftlIzroIjsnbTslrQg7KCV67O066W8IOywvuydhCDsiJgg7JeG7Iq164uI64ukLicpO1xuICB9XG5cbiAgLy8g66mU7Iuc7KeAIElEIOyDneyEsVxuICBjb25zdCBtZXNzYWdlSWQgPSB1dWlkdjQoKTtcbiAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICBcbiAgLy8g66mU7Iuc7KeAIOqwneyytCDsg53shLFcbiAgY29uc3QgbWVzc2FnZURhdGEgPSB7XG4gICAgaWQ6IG1lc3NhZ2VJZCxcbiAgICBnYW1lX2lkOiBnYW1lSWQsXG4gICAgdXNlcl9pZDogcGxheWVyRGF0YS51c2VyX2lkLFxuICAgIHVzZXJuYW1lOiBwbGF5ZXJEYXRhLnVzZXJuYW1lLFxuICAgIGNvbnRlbnQ6IGNvbnRlbnQsXG4gICAgY3JlYXRlZF9hdDogdGltZXN0YW1wXG4gIH07XG4gIFxuICAvLyDrqZTsi5zsp4Ag7KCA7J6lXG4gIGNvbnN0IHsgZXJyb3I6IG1lc3NhZ2VFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbSgnbWVzc2FnZXMnKVxuICAgIC5pbnNlcnQobWVzc2FnZURhdGEpO1xuICBcbiAgaWYgKG1lc3NhZ2VFcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+uplOyLnOyngCDsoIDsnqUg7Jik66WYOicsIG1lc3NhZ2VFcnJvcik7XG4gICAgdGhyb3cgbmV3IEVycm9yKCfrqZTsi5zsp4Drpbwg7KCE7Iah7ZWgIOyImCDsl4bsirXri4jri6Q6ICcgKyBtZXNzYWdlRXJyb3IubWVzc2FnZSk7XG4gIH1cbn1cblxuLyoqXG4gKiDqsozsnoQg7JWh7IWYIOq4sOuhnVxuICovXG5hc3luYyBmdW5jdGlvbiByZWNvcmRHYW1lQWN0aW9uKFxuICBnYW1lSWQ6IHN0cmluZyxcbiAgYWN0aW9uVHlwZTogQmV0QWN0aW9uVHlwZSB8ICdzaG93JyB8ICdzdGFydCcgfCAncmVnYW1lJyxcbiAgcGxheWVySWQ6IHN0cmluZyB8IG51bGwsXG4gIGFtb3VudD86IG51bWJlclxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgLmZyb20oJ2dhbWVfYWN0aW9ucycpXG4gICAgLmluc2VydCh7XG4gICAgICBnYW1lX2lkOiBnYW1lSWQsXG4gICAgICBwbGF5ZXJfaWQ6IHBsYXllcklkLFxuICAgICAgYWN0aW9uX3R5cGU6IGFjdGlvblR5cGUsXG4gICAgICBhbW91bnQ6IGFtb3VudFxuICAgIH0pO1xuXG4gIGlmIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+qyjOyehCDslaHshZgg6riw66GdIOyYpOulmDonLCBlcnJvcik7XG4gICAgLy8g7JWh7IWYIOq4sOuhnSDsi6TtjKjripQg6rKM7J6EIOynhO2WieyXkCDsuZjrqoXsoIHsnbTsp4Ag7JWK7Jy866+A66GcIOyYpOulmOulvCDrjZjsp4Dsp4Ag7JWK7J2MXG4gICAgY29uc29sZS53YXJuKCfqsozsnoQg7JWh7IWY7J2EIOq4sOuhne2VoCDsiJgg7JeG7Iq164uI64ukLicpO1xuICB9XG59XG5cbi8qKlxuICog7IWU7ZSM65CcIOy5tOuTnCDrjbEg7IOd7ISxXG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZVNodWZmbGVkRGVjaygpOiBudW1iZXJbXSB7XG4gIC8vIDHrtoDthLAgMjDquYzsp4DsnZgg7Lm065OcIOyDneyEsSAo7ISv64ukIOy5tOuTnClcbiAgY29uc3QgZGVjayA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDIwIH0sIChfLCBpKSA9PiBpICsgMSk7XG4gIFxuICAvLyDrjbEg7IWU7ZSMIChGaXNoZXItWWF0ZXMg7JWM6rOg66as7KaYKVxuICBmb3IgKGxldCBpID0gZGVjay5sZW5ndGggLSAxOyBpID4gMDsgaS0tKSB7XG4gICAgY29uc3QgaiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChpICsgMSkpO1xuICAgIFtkZWNrW2ldLCBkZWNrW2pdXSA9IFtkZWNrW2pdLCBkZWNrW2ldXTtcbiAgfVxuICBcbiAgcmV0dXJuIGRlY2s7XG59XG5cbi8qKlxuICog66qo65OgIO2UjOugiOydtOyWtOqwgCDthLTsnYQg6rCA7KGM64qU7KeAIO2ZleyduFxuICovXG5hc3luYyBmdW5jdGlvbiBjaGVja0FsbFBsYXllcnNIYWRUdXJuKGdhbWVJZDogc3RyaW5nLCBwbGF5ZXJzOiBQbGF5ZXJbXSk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICBjb25zdCBhY3RpdmVQbGF5ZXJzID0gcGxheWVycy5maWx0ZXIocCA9PiAhcC5pc0RpZSk7XG4gIFxuICAvLyDqsozsnoQg7Iuc7J6RIOydtO2bhCDqsIEg7ZSM66CI7J207Ja067OEIOqwgOyepSDstZzqt7wg7JWh7IWYIO2ZleyduFxuICBjb25zdCBwbGF5ZXJMYXN0QWN0aW9ucyA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuICBcbiAgLy8g6rKM7J6E7J2YIOuniOyngOuniSDrnbzsmrTrk5wg7Iuc7J6RIOyLnOqwhCDssL7quLAgKHN0YXJ0IOyVoeyFmCDrmJDripQg6rCA7J6lIOyYpOuemOuQnCDrsqDtjIUg7JWh7IWYKVxuICBjb25zdCB7IGRhdGE6IHN0YXJ0QWN0aW9uLCBlcnJvcjogc3RhcnRFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbSgnZ2FtZV9hY3Rpb25zJylcbiAgICAuc2VsZWN0KCdjcmVhdGVkX2F0JylcbiAgICAuZXEoJ2dhbWVfaWQnLCBnYW1lSWQpXG4gICAgLmVxKCdhY3Rpb25fdHlwZScsICdzdGFydCcpXG4gICAgLm9yZGVyKCdjcmVhdGVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG4gICAgLmxpbWl0KDEpO1xuICBcbiAgaWYgKHN0YXJ0RXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfqsozsnoQg7Iuc7J6RIOyVoeyFmCDsobDtmowg7Jik66WYOicsIHN0YXJ0RXJyb3IpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBcbiAgY29uc3Qgcm91bmRTdGFydFRpbWUgPSBzdGFydEFjdGlvbiAmJiBzdGFydEFjdGlvbi5sZW5ndGggPiAwIFxuICAgID8gc3RhcnRBY3Rpb25bMF0uY3JlYXRlZF9hdCBcbiAgICA6IG5ldyBEYXRlKDApLnRvSVNPU3RyaW5nKCk7XG4gIFxuICAvLyDqsIEg7Zmc7ISxIO2UjOugiOydtOyWtOuzhOuhnCDrp4jsp4Drp4kg7JWh7IWYIO2ZleyduFxuICBmb3IgKGNvbnN0IHBsYXllciBvZiBhY3RpdmVQbGF5ZXJzKSB7XG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdnYW1lX2FjdGlvbnMnKVxuICAgICAgLnNlbGVjdCgncGxheWVyX2lkJylcbiAgICAgIC5lcSgnZ2FtZV9pZCcsIGdhbWVJZClcbiAgICAgIC5lcSgncGxheWVyX2lkJywgcGxheWVyLmlkKVxuICAgICAgLmluKCdhY3Rpb25fdHlwZScsIFsnYmV0JywgJ2NhbGwnLCAncmFpc2UnLCAnaGFsZicsICdjaGVjaycsICdkaWUnXSlcbiAgICAgIC5ndCgnY3JlYXRlZF9hdCcsIHJvdW5kU3RhcnRUaW1lKVxuICAgICAgLm9yZGVyKCdjcmVhdGVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG4gICAgICAubGltaXQoMSk7XG4gICAgICBcbiAgICBpZiAoZXJyb3IgfHwgIWRhdGEgfHwgZGF0YS5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBmYWxzZTsgLy8g7ZSM66CI7J207Ja06rCAIO2YhOyerCDrnbzsmrTrk5zsl5DshJwg7JWh7IWY7J2EIOy3qO2VmOyngCDslYrslZjsnYxcbiAgICB9XG4gICAgXG4gICAgcGxheWVyTGFzdEFjdGlvbnMuYWRkKHBsYXllci5pZCk7XG4gIH1cbiAgXG4gIC8vIOuqqOuToCDtmZzshLEg7ZSM66CI7J207Ja06rCAIOyVoeyFmOydhCDst6jtlojripTsp4Ag7ZmV7J24XG4gIHJldHVybiBwbGF5ZXJMYXN0QWN0aW9ucy5zaXplID09PSBhY3RpdmVQbGF5ZXJzLmxlbmd0aDtcbn1cblxuLyoqXG4gKiDqsozsnoQg7KKF66OMIOyymOumrFxuICovXG5hc3luYyBmdW5jdGlvbiBmaW5pc2hHYW1lKGdhbWVJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gIC8vIOqyjOyehCDsg4Htg5wg7KGw7ZqMXG4gIGNvbnN0IGdhbWVTdGF0ZSA9IGF3YWl0IGdldEdhbWVTdGF0ZShnYW1lSWQpO1xuICBcbiAgLy8g7Zmc7ISxIO2UjOugiOydtOyWtCAo64uk7J207ZWY7KeAIOyViuydgCDtlIzroIjsnbTslrQg7KSRIOy5tOuTnOqwgCDsnojripQg7ZSM66CI7J207Ja0KVxuICBjb25zdCBhY3RpdmVQbGF5ZXJzID0gZ2FtZVN0YXRlLnBsYXllcnNcbiAgICAuZmlsdGVyKHAgPT4gIXAuaXNEaWUgJiYgcC5jYXJkcyAmJiBwLmNhcmRzLmxlbmd0aCA9PT0gMilcbiAgICAubWFwKHAgPT4gKHtcbiAgICAgIGlkOiBwLmlkLFxuICAgICAgY2FyZHM6IHAuY2FyZHMgYXMgbnVtYmVyW10sXG4gICAgICBpc0RpZTogcC5pc0RpZSB8fCBmYWxzZVxuICAgIH0pKTtcbiAgXG4gIGlmIChhY3RpdmVQbGF5ZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+2ZnOyEsSDtlIzroIjsnbTslrTqsIAg7JeG7Iq164uI64ukJyk7XG4gICAgcmV0dXJuO1xuICB9XG4gIFxuICAvLyDsirnsnpAg6rKw7KCVXG4gIGNvbnN0IHsgd2lubmVySWQsIGlzUmVnYW1lIH0gPSBkZXRlcm1pbmVXaW5uZXIoYWN0aXZlUGxheWVycyk7XG4gIFxuICAvLyDsnqzqsr3quLAg7LKY66asXG4gIGlmIChpc1JlZ2FtZSkge1xuICAgIGF3YWl0IGhhbmRsZVJlZ2FtZShnYW1lSWQpO1xuICAgIHJldHVybjtcbiAgfVxuICBcbiAgaWYgKCF3aW5uZXJJZCkge1xuICAgIGNvbnNvbGUubG9nKCfsirnsnpDrpbwg6rKw7KCV7ZWgIOyImCDsl4bsnYwgKOq1rOyCrCDrk7HsnZgg7Yq57IiYIOyDge2ZqSknKTtcbiAgICByZXR1cm47XG4gIH1cbiAgXG4gIC8vIOyKueyekCDssL7quLBcbiAgY29uc3Qgd2lubmVyID0gZ2FtZVN0YXRlLnBsYXllcnMuZmluZChwID0+IHAuaWQgPT09IHdpbm5lcklkKTtcbiAgaWYgKCF3aW5uZXIpIHtcbiAgICBjb25zb2xlLmVycm9yKCfsirnsnpAg7KCV67O066W8IOywvuydhCDsiJgg7JeG7J2MJyk7XG4gICAgcmV0dXJuO1xuICB9XG4gIFxuICAvLyDrlaHqsJIg6rOE7IKwIOyymOumrFxuICBsZXQgd2lubmluZ3MgPSBnYW1lU3RhdGUuYmV0dGluZ1ZhbHVlO1xuICBsZXQgZGFuZ1ZhbHVlczogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xuICBcbiAgLy8g7Zmc7ISxIO2UjOugiOydtOyWtCDspJEg7Yyo7J6Q65OkIO2ZleyduFxuICBmb3IgKGNvbnN0IHBsYXllciBvZiBnYW1lU3RhdGUucGxheWVycy5maWx0ZXIocCA9PiAhcC5pc0RpZSAmJiBwLmlkICE9PSB3aW5uZXJJZCkpIHtcbiAgICAvLyDsirnsnpAg7YyoIO2ZleyduFxuICAgIGNvbnN0IHdpbm5lckV2YWwgPSBldmFsdWF0ZUNhcmRzKHdpbm5lci5jYXJkcyB8fCBbXSk7XG4gICAgLy8g7Yyo7J6QIO2MqCDtmZXsnbhcbiAgICBjb25zdCBsb3NlckV2YWwgPSBldmFsdWF0ZUNhcmRzKHBsYXllci5jYXJkcyB8fCBbXSk7XG4gICAgXG4gICAgLy8g65Wh6rCSIOqzhOyCsCAtIOyKueyekOqwgCDrlaHsnqHsnbTqs6Ag7Yyo7J6Q6rCAIOuVoeydvCDqsr3smrBcbiAgICBpZiAod2lubmVyRXZhbC5yYW5rID09PSAn65Wh7J6h7J20JyAmJiBsb3NlckV2YWwucmFuay5pbmNsdWRlcygn65WhJykgJiYgXG4gICAgICAgIWxvc2VyRXZhbC5yYW5rLmluY2x1ZGVzKCfqtJHrlaEnKSAmJiBsb3NlckV2YWwucmFuayAhPT0gJzEw65WhJykge1xuICAgICAgY29uc3QgZGFuZ1ZhbHVlID0gY2FsY3VsYXRlRGFuZ1ZhbHVlKGxvc2VyRXZhbC5yYW5rLCBnYW1lU3RhdGUuYmV0dGluZ1ZhbHVlKTtcbiAgICAgIGRhbmdWYWx1ZXNbcGxheWVyLmlkXSA9IGRhbmdWYWx1ZTtcbiAgICAgIHdpbm5pbmdzICs9IGRhbmdWYWx1ZTtcbiAgICB9XG4gICAgXG4gICAgLy8g7JWU7ZaJ7Ja07IKs7JmAIOq0keuVoSDsspjrpqxcbiAgICBpZiAod2lubmVyRXZhbC5yYW5rID09PSAn7JWU7ZaJ7Ja07IKsJyAmJiBcbiAgICAgICAobG9zZXJFdmFsLnJhbmsgPT09ICcxM+q0keuVoScgfHwgbG9zZXJFdmFsLnJhbmsgPT09ICcxOOq0keuVoScpKSB7XG4gICAgICAvLyDqtJHrlaHsl5Ag64yA7ZWcIOyVlO2WieyWtOyCrCDrsLDri7kgKOydvOuwmOyggeycvOuhnCAz67CwKVxuICAgICAgY29uc3QgYW1oYWVuZ1ZhbHVlID0gZ2FtZVN0YXRlLmJldHRpbmdWYWx1ZSAqIDM7XG4gICAgICBkYW5nVmFsdWVzW3BsYXllci5pZF0gPSBhbWhhZW5nVmFsdWU7XG4gICAgICB3aW5uaW5ncyArPSBhbWhhZW5nVmFsdWU7XG4gICAgfVxuICAgIFxuICAgIC8vIDM46rSR65Wh7J20IOuLpOuluCDqtJHrlaHsnYQg7J206rK87J2EIOqyveyasCAo7IOB7JyEIOq0keuVoeydtCDtlZjsnIQg6rSR65WhIOuwsOuLuSlcbiAgICBpZiAod2lubmVyRXZhbC5yYW5rID09PSAnMzjqtJHrlaEnICYmIFxuICAgICAgIChsb3NlckV2YWwucmFuayA9PT0gJzEz6rSR65WhJyB8fCBsb3NlckV2YWwucmFuayA9PT0gJzE46rSR65WhJykpIHtcbiAgICAgIGNvbnN0IGd3YW5nRGFuZ1ZhbHVlID0gZ2FtZVN0YXRlLmJldHRpbmdWYWx1ZSAqIDI7XG4gICAgICBkYW5nVmFsdWVzW3BsYXllci5pZF0gPSBnd2FuZ0RhbmdWYWx1ZTtcbiAgICAgIHdpbm5pbmdzICs9IGd3YW5nRGFuZ1ZhbHVlO1xuICAgIH1cbiAgfVxuICBcbiAgLy8g7Iq57J6Q7J2YIOyelOyVoSDsl4XrjbDsnbTtirhcbiAgY29uc3QgeyBlcnJvcjogd2lubmVyVXBkYXRlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgLmZyb20oJ3BsYXllcnMnKVxuICAgIC51cGRhdGUoe1xuICAgICAgYmFsYW5jZTogd2lubmVyLmJhbGFuY2UgKyB3aW5uaW5nc1xuICAgIH0pXG4gICAgLmVxKCdpZCcsIHdpbm5lcklkKTtcbiAgXG4gIGlmICh3aW5uZXJVcGRhdGVFcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+yKueyekCDsnpTslaEg7JeF642w7J207Yq4IOyYpOulmDonLCB3aW5uZXJVcGRhdGVFcnJvcik7XG4gICAgdGhyb3cgbmV3IEVycm9yKCfsirnsnpAg7J6U7JWh7J2EIOyXheuNsOydtO2KuO2VoCDsiJgg7JeG7Iq164uI64ukLicpO1xuICB9XG4gIFxuICAvLyDrlaHqsJLsnbQg7J6I64uk66m0IO2MqOyekOuTpOydmCDsnpTslaEg7LaU6rCAIOywqOqwkFxuICBmb3IgKGNvbnN0IFtwbGF5ZXJJZCwgZGFuZ1ZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhkYW5nVmFsdWVzKSkge1xuICAgIGNvbnN0IGxvc2VyID0gZ2FtZVN0YXRlLnBsYXllcnMuZmluZChwID0+IHAuaWQgPT09IHBsYXllcklkKTtcbiAgICBpZiAobG9zZXIpIHtcbiAgICAgIGNvbnN0IHsgZXJyb3I6IGxvc2VyVXBkYXRlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdwbGF5ZXJzJylcbiAgICAgICAgLnVwZGF0ZSh7XG4gICAgICAgICAgYmFsYW5jZTogTWF0aC5tYXgoMCwgbG9zZXIuYmFsYW5jZSAtIGRhbmdWYWx1ZSkgLy8g7LWc7IaMIDDsnLzroZwg7KCc7ZWcXG4gICAgICAgIH0pXG4gICAgICAgIC5lcSgnaWQnLCBwbGF5ZXJJZCk7XG4gICAgICBcbiAgICAgIGlmIChsb3NlclVwZGF0ZUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+2MqOyekCDsnpTslaEg7JeF642w7J207Yq4IOyYpOulmDonLCBsb3NlclVwZGF0ZUVycm9yKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgXG4gIC8vIOqyjOyehCDsg4Htg5wg7JeF642w7J207Yq4XG4gIGNvbnN0IHsgZXJyb3I6IGdhbWVVcGRhdGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbSgnZ2FtZXMnKVxuICAgIC51cGRhdGUoe1xuICAgICAgc3RhdHVzOiAnZmluaXNoZWQnLFxuICAgICAgd2lubmVyOiB3aW5uZXJJZCxcbiAgICAgIHNob3dfY2FyZHM6IHRydWUsXG4gICAgICBkYW5nX3ZhbHVlczogZGFuZ1ZhbHVlc1xuICAgIH0pXG4gICAgLmVxKCdpZCcsIGdhbWVJZCk7XG4gIFxuICBpZiAoZ2FtZVVwZGF0ZUVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign6rKM7J6EIOyiheujjCDsg4Htg5wg7JeF642w7J207Yq4IOyYpOulmDonLCBnYW1lVXBkYXRlRXJyb3IpO1xuICAgIHRocm93IG5ldyBFcnJvcign6rKM7J6E7J2EIOyiheujjO2VoCDsiJgg7JeG7Iq164uI64ukLicpO1xuICB9XG4gIFxuICAvLyDqsrDqs7wg7JWh7IWYIOq4sOuhnVxuICBhd2FpdCByZWNvcmRHYW1lQWN0aW9uKGdhbWVJZCwgJ3Nob3cnLCB3aW5uZXJJZCk7XG59XG5cbi8vIOuVoeqwkiDqs4TsgrAg7ZWo7IiYXG5mdW5jdGlvbiBjYWxjdWxhdGVEYW5nVmFsdWUocmFuazogc3RyaW5nLCBiZXR0aW5nVmFsdWU6IG51bWJlcik6IG51bWJlciB7XG4gIC8vIOq0keuVoSDrsLDri7lcbiAgaWYgKHJhbmsgPT09ICczOOq0keuVoScpIHJldHVybiBiZXR0aW5nVmFsdWUgKiAxMDtcbiAgaWYgKHJhbmsgPT09ICcxM+q0keuVoScpIHJldHVybiBiZXR0aW5nVmFsdWUgKiA4O1xuICBpZiAocmFuayA9PT0gJzE46rSR65WhJykgcmV0dXJuIGJldHRpbmdWYWx1ZSAqIDc7XG4gIFxuICAvLyDsnbzrsJgg65WhIOuwsOuLuVxuICBpZiAocmFuayA9PT0gJzEw65WhJyB8fCByYW5rID09PSAn7J6l65WhJykgcmV0dXJuIGJldHRpbmdWYWx1ZSAqIDU7XG4gIGlmIChyYW5rID09PSAnOeuVoScpIHJldHVybiBiZXR0aW5nVmFsdWUgKiA0LjU7XG4gIGlmIChyYW5rID09PSAnOOuVoScpIHJldHVybiBiZXR0aW5nVmFsdWUgKiA0O1xuICBpZiAocmFuayA9PT0gJzfrlaEnKSByZXR1cm4gYmV0dGluZ1ZhbHVlICogMy41O1xuICBpZiAocmFuayA9PT0gJzbrlaEnKSByZXR1cm4gYmV0dGluZ1ZhbHVlICogMztcbiAgaWYgKHJhbmsgPT09ICc165WhJykgcmV0dXJuIGJldHRpbmdWYWx1ZSAqIDIuNTtcbiAgaWYgKHJhbmsgPT09ICc065WhJykgcmV0dXJuIGJldHRpbmdWYWx1ZSAqIDI7XG4gIGlmIChyYW5rID09PSAnM+uVoScpIHJldHVybiBiZXR0aW5nVmFsdWUgKiAxLjU7XG4gIGlmIChyYW5rID09PSAnMuuVoScpIHJldHVybiBiZXR0aW5nVmFsdWUgKiAxLjI1O1xuICBpZiAocmFuayA9PT0gJzHrlaEnKSByZXR1cm4gYmV0dGluZ1ZhbHVlICogMTtcbiAgXG4gIC8vIO2KueyImCDsobDtlakg67Cw64u5XG4gIGlmIChyYW5rID09PSAn7JWU7ZaJ7Ja07IKsJykgcmV0dXJuIGJldHRpbmdWYWx1ZSAqIDM7IC8vIOq0keuVoSDsnqHslZjsnYQg65WMXG4gIFxuICByZXR1cm4gMDsgLy8g65Wh7J20IOyVhOuLjCDqsr3smrBcbn1cblxuLy8g7J6s6rK96riwIOyymOumrCDtlajsiJhcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZVJlZ2FtZShnYW1lSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCBnYW1lU3RhdGUgPSBhd2FpdCBnZXRHYW1lU3RhdGUoZ2FtZUlkKTtcbiAgXG4gIC8vIO2UjOugiOydtOyWtOuTpCDsubTrk5wg7LSI6riw7ZmUIFxuICBmb3IgKGNvbnN0IHBsYXllciBvZiBnYW1lU3RhdGUucGxheWVycykge1xuICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgncGxheWVycycpXG4gICAgICAudXBkYXRlKHsgY2FyZHM6IG51bGwsIGlzX2RpZTogZmFsc2UgfSlcbiAgICAgIC5lcSgnaWQnLCBwbGF5ZXIuaWQpO1xuICAgICAgXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCftlIzroIjsnbTslrQg7Lm065OcIOy0iOq4sO2ZlCDsmKTrpZg6JywgZXJyb3IpO1xuICAgIH1cbiAgfVxuICBcbiAgLy8g6rKM7J6EIOyDge2DnCDsl4XrjbDsnbTtirggLSDrsLDtjIXqsJLsnYAg7Jyg7KeA7ZWY66mwIOyerOyLnOyekVxuICBjb25zdCB7IGVycm9yOiBnYW1lVXBkYXRlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgLmZyb20oJ2dhbWVzJylcbiAgICAudXBkYXRlKHtcbiAgICAgIHN0YXR1czogJ3JlZ2FtZScsXG4gICAgICBjdXJyZW50X3R1cm46IG51bGwsXG4gICAgICB3aW5uZXI6IG51bGwsXG4gICAgICByZWdhbWVfc3RhcnRfdGltZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgcmVnYW1lX3dhaXRfdGltZTogUkVHQU1FX1dBSVRfVElNRV9NU1xuICAgIH0pXG4gICAgLmVxKCdpZCcsIGdhbWVJZCk7XG4gIFxuICBpZiAoZ2FtZVVwZGF0ZUVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign7J6s6rK96riwIOyEpOyglSDsmKTrpZg6JywgZ2FtZVVwZGF0ZUVycm9yKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ+yerOqyveq4sOulvCDshKTsoJXtlaAg7IiYIOyXhuyKteuLiOuLpC4nKTtcbiAgfVxuICBcbiAgLy8g7J6s6rK96riwIOyVoeyFmCDquLDroZ1cbiAgYXdhaXQgcmVjb3JkR2FtZUFjdGlvbihnYW1lSWQsICdyZWdhbWUnLCBudWxsKTtcbiAgXG4gIC8vIDHstIjrp4jri6Qg64yA6riwIOyLnOqwhCDsl4XrjbDsnbTtirhcbiAgbGV0IHJlbWFpbmluZ1RpbWUgPSBNYXRoLmZsb29yKFJFR0FNRV9XQUlUX1RJTUVfTVMgLyAxMDAwKTtcbiAgXG4gIGNvbnN0IGludGVydmFsSWQgPSBzZXRJbnRlcnZhbChhc3luYyAoKSA9PiB7XG4gICAgcmVtYWluaW5nVGltZS0tO1xuICAgIFxuICAgIC8vIOuCqOydgCDsi5zqsIQg7JeF642w7J207Yq4XG4gICAgYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdnYW1lcycpXG4gICAgICAudXBkYXRlKHsgcmVnYW1lX3JlbWFpbmluZ190aW1lOiByZW1haW5pbmdUaW1lIH0pXG4gICAgICAuZXEoJ2lkJywgZ2FtZUlkKTtcbiAgICAgIFxuICAgIGlmIChyZW1haW5pbmdUaW1lIDw9IDApIHtcbiAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWxJZCk7XG4gICAgfVxuICB9LCAxMDAwKTtcbiAgXG4gIC8vIOyeoOyLnCDtm4Qg6rKM7J6EIOyerOyLnOyekVxuICBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcbiAgICB0cnkge1xuICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbElkKTsgLy8g7Zi57IucIOuCqOyVhOyeiOuKlCDsnbjthLDrsowg7KCV66asXG4gICAgICBhd2FpdCBzdGFydEdhbWUoZ2FtZUlkKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+yerOqyveq4sCDsi5zsnpEg7Jik66WYOicsIGVycik7XG4gICAgfVxuICB9LCBSRUdBTUVfV0FJVF9USU1FX01TKTtcbn1cblxuLy8g7ZSM66CI7J207Ja0IOyijOyEnSDsl4XrjbDsnbTtirhcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVTZWF0KGdhbWVJZDogc3RyaW5nLCBwbGF5ZXJJZDogc3RyaW5nLCBzZWF0SW5kZXg6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xuICB0cnkge1xuICAgIC8vIO2VtOuLuSDsoozshJ3snbQg7J2066+4IOyCrOyaqSDspJHsnbjsp4Ag7ZmV7J24XG4gICAgY29uc3QgeyBkYXRhOiBleGlzdGluZ1BsYXllciwgZXJyb3I6IGNoZWNrRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgncGxheWVycycpXG4gICAgICAuc2VsZWN0KCdpZCcpXG4gICAgICAuZXEoJ2dhbWVfaWQnLCBnYW1lSWQpXG4gICAgICAuZXEoJ3NlYXRfaW5kZXgnLCBzZWF0SW5kZXgpO1xuXG4gICAgaWYgKGNoZWNrRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+yijOyEnSDtmZXsnbgg7Jik66WYOicsIGNoZWNrRXJyb3IpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCfsoozshJ0g7KCV67O066W8IO2ZleyduO2VoCDsiJgg7JeG7Iq164uI64ukLicpO1xuICAgIH1cblxuICAgIC8vIOydtOuvuCDri6Trpbgg7ZSM66CI7J207Ja06rCAIO2VtOuLuSDsoozshJ3sl5Ag7JWJ7JWE7J6I7Jy866m0IOyYpOulmFxuICAgIGlmIChleGlzdGluZ1BsYXllciAmJiBleGlzdGluZ1BsYXllci5sZW5ndGggPiAwICYmIGV4aXN0aW5nUGxheWVyWzBdLmlkICE9PSBwbGF5ZXJJZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCfsnbTrr7gg64uk66W4IO2UjOugiOydtOyWtOqwgCDsgqzsmqkg7KSR7J24IOyijOyEneyeheuLiOuLpC4nKTtcbiAgICB9XG5cbiAgICAvLyDtlIzroIjsnbTslrQg7KKM7ISdIOyXheuNsOydtO2KuFxuICAgIGNvbnN0IHsgZXJyb3I6IHVwZGF0ZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3BsYXllcnMnKVxuICAgICAgLnVwZGF0ZSh7IHNlYXRfaW5kZXg6IHNlYXRJbmRleCB9KVxuICAgICAgLmVxKCdnYW1lX2lkJywgZ2FtZUlkKVxuICAgICAgLmVxKCdpZCcsIHBsYXllcklkKTtcblxuICAgIGlmICh1cGRhdGVFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign7KKM7ISdIOyXheuNsOydtO2KuCDsmKTrpZg6JywgdXBkYXRlRXJyb3IpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCfsoozshJ3snYQg7JeF642w7J207Yq47ZWgIOyImCDsl4bsirXri4jri6Q6ICcgKyB1cGRhdGVFcnJvci5tZXNzYWdlKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+yijOyEnSDsl4XrjbDsnbTtirgg7KSRIOyYiOyZuCDrsJzsg506JywgZXJyKTtcbiAgICB0aHJvdyBlcnI7XG4gIH1cbn0gIl0sIm5hbWVzIjpbInN1cGFiYXNlIiwidjQiLCJ1dWlkdjQiLCJkZXRlcm1pbmVXaW5uZXIiLCJldmFsdWF0ZUNhcmRzIiwiUkVHQU1FX1dBSVRfVElNRV9NUyIsImNyZWF0ZUdhbWUiLCJ1c2VybmFtZSIsImdhbWVJZCIsInBsYXllcklkIiwidXNlcklkIiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic3RyaW5nIiwiZGF0YSIsImdhbWVEYXRhIiwiZXJyb3IiLCJnYW1lRXJyb3IiLCJmcm9tIiwiaW5zZXJ0IiwiaWQiLCJzdGF0dXMiLCJjdXJyZW50X3R1cm4iLCJiZXR0aW5nX3ZhbHVlIiwid2lubmVyIiwic2VsZWN0IiwiY29uc29sZSIsIkVycm9yIiwibWVzc2FnZSIsImxvZyIsImVyciIsImpvaW5HYW1lIiwic2VhdEluZGV4IiwiZXEiLCJzaW5nbGUiLCJzdG9yZWRVc2VySWQiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwic3RvcmVkUGxheWVySWQiLCJleGlzdGluZ1BsYXllciIsImV4aXN0aW5nUGxheWVyRXJyb3IiLCJ1cGRhdGUiLCJnYW1lU3RhdGUiLCJnZXRHYW1lU3RhdGUiLCJyZWpvaW5lZCIsInBsYXllckRhdGEiLCJwbGF5ZXJFcnJvciIsImdhbWVfaWQiLCJ1c2VyX2lkIiwiYmFsYW5jZSIsImlzX2RpZSIsInNlYXRfaW5kZXgiLCJzZXRJdGVtIiwicGxheWVyc0RhdGEiLCJwbGF5ZXJzRXJyb3IiLCJyZWdhbWVSZW1haW5pbmdUaW1lIiwidW5kZWZpbmVkIiwicmVnYW1lX3N0YXJ0X3RpbWUiLCJyZWdhbWVfd2FpdF90aW1lIiwic3RhcnRUaW1lIiwiRGF0ZSIsImdldFRpbWUiLCJjdXJyZW50VGltZSIsImVsYXBzZWRNcyIsInJlbWFpbmluZ01zIiwibWF4IiwiY2VpbCIsInBsYXllcnMiLCJtYXAiLCJwbGF5ZXIiLCJjYXJkcyIsImlzRGllIiwiY3VycmVudFR1cm4iLCJiZXR0aW5nVmFsdWUiLCJyZWdhbWVfcmVtYWluaW5nX3RpbWUiLCJzdGFydEdhbWUiLCJsZW5ndGgiLCJkZWNrIiwiY3JlYXRlU2h1ZmZsZWREZWNrIiwiaSIsInBsYXllckNhcmRzIiwicG9wIiwiZmlsdGVyIiwiQm9vbGVhbiIsInVwZGF0ZUVycm9yIiwiZmlyc3RUdXJuIiwiZmxvb3IiLCJyZWNvcmRHYW1lQWN0aW9uIiwicGxhY2VCZXQiLCJhY3Rpb25UeXBlIiwiYW1vdW50IiwiZmluZCIsInAiLCJhY3Rpb25zRGF0YSIsImFjdGlvbnNFcnJvciIsIm9yZGVyIiwiYXNjZW5kaW5nIiwibGltaXQiLCJsYXN0QmV0QWN0aW9uIiwiYWN0aW9uIiwiaW5jbHVkZXMiLCJhY3Rpb25fdHlwZSIsInBsYXllcl9pZCIsImJldEFtb3VudCIsImJhc2VCZXQiLCJtaW5CZXQiLCJwbGF5ZXJVcGRhdGVFcnJvciIsImFjdGl2ZVBsYXllcnMiLCJ3aW5uZXJVcGRhdGVFcnJvciIsImdhbWVVcGRhdGVFcnJvciIsIm5leHRQbGF5ZXJUdXJuSWQiLCJnZXROZXh0UGxheWVyVHVybiIsImFsbFBsYXllcnNUb29rQWN0aW9uIiwiY2hlY2tBbGxQbGF5ZXJzSGFkVHVybiIsImFsbFBsYXllcnNNYXRjaGVkQmV0IiwiY2hlY2tBbGxQbGF5ZXJzTWF0Y2hlZEJldCIsImZpbmlzaEdhbWUiLCJwbGF5ZXJMYXN0QmV0cyIsImluIiwiYmV0QW1vdW50cyIsIk9iamVjdCIsInZhbHVlcyIsImV2ZXJ5IiwiY3VycmVudFBsYXllcklkIiwiY3VycmVudEluZGV4IiwiZmluZEluZGV4IiwibmV4dEluZGV4Iiwic2VuZE1lc3NhZ2UiLCJjb250ZW50IiwidHJpbSIsIm1lc3NhZ2VJZCIsInRpbWVzdGFtcCIsInRvSVNPU3RyaW5nIiwibWVzc2FnZURhdGEiLCJjcmVhdGVkX2F0IiwibWVzc2FnZUVycm9yIiwid2FybiIsIkFycmF5IiwiXyIsImoiLCJwbGF5ZXJMYXN0QWN0aW9ucyIsIlNldCIsInN0YXJ0QWN0aW9uIiwic3RhcnRFcnJvciIsInJvdW5kU3RhcnRUaW1lIiwiZ3QiLCJhZGQiLCJzaXplIiwid2lubmVySWQiLCJpc1JlZ2FtZSIsImhhbmRsZVJlZ2FtZSIsIndpbm5pbmdzIiwiZGFuZ1ZhbHVlcyIsIndpbm5lckV2YWwiLCJsb3NlckV2YWwiLCJyYW5rIiwiZGFuZ1ZhbHVlIiwiY2FsY3VsYXRlRGFuZ1ZhbHVlIiwiYW1oYWVuZ1ZhbHVlIiwiZ3dhbmdEYW5nVmFsdWUiLCJlbnRyaWVzIiwibG9zZXIiLCJsb3NlclVwZGF0ZUVycm9yIiwic2hvd19jYXJkcyIsImRhbmdfdmFsdWVzIiwicmVtYWluaW5nVGltZSIsImludGVydmFsSWQiLCJzZXRJbnRlcnZhbCIsImNsZWFySW50ZXJ2YWwiLCJzZXRUaW1lb3V0IiwidXBkYXRlU2VhdCIsImNoZWNrRXJyb3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/lib/gameApi.ts\n"));

/***/ })

});